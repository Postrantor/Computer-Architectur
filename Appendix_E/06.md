## Case Study: Sanyo VPC-SX500 Digital Camera

Another very familiar embedded system is a digital camera. Here we consider the Sanyo VPC-SX500. When powered on, the microprocessor of the camera first runs diagnostics on all components and writes any error messages to the liquid crystal display (LCD) on the back of the camera. This camera uses a 1.8-inch low-temperature polysilicon thin-film transistor (TFT) color LCD. When a pho- tographer takes a picture, he first holds the shutter halfway so that the micropro- cessor can take a light reading. The microprocessor then keeps the shutter open to get the necessary light, which is captured by a charge-coupled device (CCD) as red, green, and blue pixels. The CCD is a 1/2-inch, 1360 1024-pixel, progressive-scan chip. The pixels are scanned out row by row; passed through routines for white balance, color, and aliasing correction; and then stored in a 4 MB frame buffer. The next step is to compress the image into a standard format, such as JPEG, and store it in the removable Flash memory. The photographer picks the compression, in this camera called either `fine` or _normal_, with a com- pression ratio of 10 to 20 times. A 512 MB Flash memory can store at least 1200 fine-quality compressed images or approximately 2000 normal-quality com- pressed images. The microprocessor then updates the LCD display to show that there is room for one less picture.

> 另一个非常熟悉的嵌入式系统是数码相机。这里我们考虑 Sanyo VPC-SX500。开机时，相机的微处理器首先对所有组件进行诊断，并将任何错误消息写入相机背面的液晶显示屏 (LCD)。本相机采用 1.8 英寸低温多晶硅薄膜晶体管 (TFT) 彩色液晶显示屏。当摄影师拍照时，他首先将快门保持在一半位置，以便微处理器进行轻微读取。然后微处理器保持快门打开以获得必要的光线，电荷耦合器件 (CCD) 将其捕获为红色、绿色和蓝色像素。CCD 是一个 1/2 英寸、1360 1024 像素的逐行扫描芯片。逐行扫描出像素；通过白平衡、颜色和混叠校正的例程；然后存储在一个 4 MB 的帧缓冲区中。下一步是将图像压缩成标准格式，例如 JPEG，并将其存储在可移动闪存中。摄影师选择压缩，在这个相机中称为 "精细" 或*正常*，压缩比为 10 到 20 倍。一个 512 MB 的闪存可以存储至少 1200 张优质压缩图像或大约 2000 张普通质量压缩图像。然后微处理器更新 LCD 显示屏以显示还有空间可以少一张图片。

Although the previous paragraph covers the basics of a digital camera, there are many more features that are included: showing the recorded images on the color LCD display, sleep mode to save battery life, monitoring battery energy, buffering to allow recording a rapid sequence of uncompressed images, and, in this camera, video recording using MPEG format and audio recording using WAV format.

> 虽然上一段介绍了数码相机的基本知识，但还包括更多功能：在彩色 LCD 显示屏上显示记录的图像、节省电池寿命的睡眠模式、监控电池电量、允许快速记录连续照片的缓冲 未压缩的图像，以及在本相机中使用 MPEG 格式录制的视频和使用 WAV 格式录制的音频。

The electronic brain of this camera is an embedded computer with several special functions embedded on the chip [Okada et al. 1999]. [Figure E.13](#_bookmark588) shows the block diagram of a chip similar to the one in the camera. As mentioned in Section E.1, such chips have been called `systems on a chip` (SOCs) because they essentially integrate into a single chip all the parts that were found on a small printed circuit board of the past. A SOC generally reduces size and lowers power compared to less integrated solutions. Sanyo claims their SOC enables the camera to operate on half the number of batteries and to offer a smaller form factor than competitors’ cameras. For higher performance, it has two buses. The 16-bit bus is for the many slower I/O devices: SmartMedia interface, program and data memory, and DMA. The 32-bit bus is for the SDRAM, the signal processor (which is connected to the CCD), the Motion JPEG encoder, and the NTSC/PAL encoder (which is connected to the LCD). Unlike desktop microprocessors, note the large variety of I/O buses that this chip must integrate. The 32-bit RISC MPU is a proprietary design and runs at 28.8 MHz, the same clock rate as the buses. This 700 mW chip contains 1.8M transistors in a 10.5 10.5 mm die implemented using a 0.35-micron process.

> 这款相机的电子大脑是一台嵌入式计算机，芯片上嵌入了多种特殊功能 [Okada et al. 1999]。[图 E.13](#_bookmark588) 显示了与相机芯片类似的芯片框图。如 E.1 节所述，此类芯片被称为 "片上系统" (SOC)，因为它们基本上将过去小型印刷电路板上的所有部件集成到单个芯片中。与集成度较低的解决方案相比，SOC 通常会减小尺寸并降低功耗。三洋声称他们的 SOC 使相机能够使用一半数量的电池运行，并提供比竞争对手相机更小的外形尺寸。为了获得更高的性能，它有两条总线。16 位总线用于许多较慢的 I/O 设备：SmartMedia 接口、程序和数据存储器以及 DMA。32 位总线用于 SDRAM、信号处理器(连接到 CCD)、Motion JPEG 编码器和 NTSC/PAL 编码器(连接到 LCD)。与桌面微处理器不同，请注意该芯片必须集成多种 I/O 总线。32 位 RISC MPU 是专有设计，运行频率为 28.8 MHz，与总线时钟频率相同。这个 700 mW 的芯片在一个 10.5 10.5 毫米的裸片中包含 180 万个晶体管，使用 0.35 微米工艺实现。

Figure E.13 The system on a chip (SOC) found in Sanyo digital cameras. This block diagram, found in Okada et al. [1999], is for the predecessor of the SOC in the camera described in the text. The successor SOC, called _Super Advanced IC_, uses three buses instead of two, operates at 60 MHz, consumes 800 mW, and fits 3.1M transistors in a 10.2 10.2 mm die using a 0.35-micron process. Note that this embedded system has twice as many transistors as the state-of-the-art, high-performance microprocessor in 1990! The SOC in the figure is limited to processing 1024 × 768 pixels, but its successor supports 1360 × 1024 pixels.

> 图 E.13 三洋数码相机中的片上系统 (SOC)。这个框图，发现于 Okada 等人。[1999]，是针对相机中 SOC 的前身所描述的文字。称为 *Super Advanced IC* 的后继 SOC 使用三个总线而不是两个，工作频率为 60 MHz，功耗为 800 mW，并使用 0.35 微米工艺在 10.2 10.2 mm 芯片中安装了 3.1M 晶体管。请注意，这个嵌入式系统的晶体管数量是 1990 年最先进的高性能微处理器的两倍！ 图中的 SOC 仅限于处理 1024 × 768 像素，但其后续产品支持 1360 × 1024 像素。
