## Network Topology

> ＃＃ 网络拓扑结构

When the number of devices is small enough, a single switch is sufficient to inter- connect them within a switched-media network. However, the number of _switch ports_ is limited by existing very-large-scale integration (VLSI) technology, cost considerations, power consumption, and so on. When the number of required _net- work ports_ exceeds the number of ports supported by a single switch, a fabric of interconnected switches is needed. To embody the necessary property of _full access_ (i.e., _connectedness_), the network switch fabric must provide a path from every end node device to every other device. All the connections to the network fabric and between switches within the fabric use point-to-point links as opposed to shared links—that is, links with only one switch or end node device on either end. The interconnection structure across all the components—including switches, links, and end node devices—is referred to as the network _topology_.

> 当设备的数量足够小时，单个开关足以将它们连接到交换机网络中。但是，_switch ports_的数量受到现有非常大规模集成（VLSI）技术，成本注意事项，功耗等的限制。当所需的_net-工作端口的数量超过单个开关支持的端口数时，需要一种互连开关的结构。要体现_full access_（即_ ConnectedNess_）的必要属性，网络开关织物必须提供从每个末端节点设备到其他设备的路径。与网络结构的所有连接以及织物内的开关之间的所有连接都使用点对点链接，而不是共享链接，即，任一端只有一个开关或结束节点设备的链接。所有组件的互连结构（包括开关，链接和结束节点设备）都称为网络_topology_。

The number of network topologies described in the literature would be difficult to count, but the number that have been used commercially is no more than about a dozen or so. During the 1970s and early 1980s, researchers struggled to propose new topologies that could reduce the number of switches through which packets must traverse, referred to as the _hop count_. In the 1990s, thanks to the introduction of pipelined transmission and switching techniques, the hop count became less crit- ical. Nevertheless, today, topology is still important, particularly for OCNs and SANs, as subtle relationships exist between topology and other network design parameters that impact performance, especially when the number of end nodes is very large (e.g., 64 K in the Blue Gene/L supercomputer) or when the latency is critical (e.g., in multicore processor chips). Topology also greatly impacts the implementation cost of the network.

> 文献中描述的网络拓扑数量很难计数，但是商业上使用的数量不超过十几个左右。在 1970 年代和 1980 年代初期，研究人员努力提出了新的拓扑结构，这些拓扑可以减少可以通过包装包的开关数量，该开关的数量被称为_hop count_。在 1990 年代，由于引入了管道的传输和开关技术，啤酒花计数变得不那么挑剔。然而，如今，拓扑仍然很重要，尤其是对于 OCN 和 SANS，因为拓扑与其他影响性能的网络设计参数之间存在微妙的关系，尤其是当末端节点的数量非常大时（例如，蓝色基因/蓝色基因 64 Kl 超级计算机）或延迟至关重要时（例如，在多层处理器芯片中）。拓扑也极大地影响了网络的实施成本。

Topologies for parallel supercomputer SANs have been the most visible and imaginative, usually converging on regularly structured ones to simplify routing, packaging, and scalability. Those for LANs and WANs tend to be more haphazard or ad hoc, having more to do with the challenges of long distance or connecting across different communication subnets. Switch-based topologies for OCNs are only recently emerging but are quickly gaining in popularity. This section describes the more popular topologies used in commercial products. Their advan- tages, disadvantages, and constraints are also briefly discussed.

> 平行超级计算机 SAN 的拓扑是最明显和富有想象力的，通常会在定期结构化的拓扑结构上融合，以简化路由，包装和可扩展性。那些用于 LAN 和 WANS 的人往往更随意或临时，与长距离的挑战或在不同的通信子网之间的挑战有关。OCN 的基于开关的拓扑直到最近才出现，但迅速越来越受欢迎。本节介绍了商业产品中使用的最受欢迎的拓扑。还简要讨论了他们的优势，缺点和约束。

### Centralized Switched Networks

> ###集中式切换网络

As mentioned above, a single switch suffices to interconnect a set of devices when the number of switch ports is equal to or larger than the number of devices. This simple network is usually referred to as a _crossbar_ or _crossbar switch_. Within the crossbar, crosspoint switch complexity increases quadratically with the number of ports, as illustrated in [Figure F.11(a)](#_bookmark609). Thus, a cheaper solution is desirable when the number of devices to be interconnected scales beyond the point supportable by implementation technology.

> 如上所述，当开关端口的数量等于或大于设备数量时，单个开关足以互连一组设备。这个简单的网络通常称为_crossbar_或_Crossbar Switch_。在横梁中，跨点开关复杂性随端口数量四倍增加，如[图 F.11（a）]（#_ bookmark609）所示。因此，当要互连的尺度的数量超出实现技术支持的点之外，就可以使用更便宜的解决方案。

A common way of addressing the crossbar scaling problem consists of splitting the large crossbar switch into several stages of smaller switches interconnected in such a way that a single pass through the switch fabric allows any destination to be reached from any source. Topologies arranged in this way are usually referred to as _multistage interconnection networks_ or _multistage switch fabrics_, and these net- works typically have complexity that increases in proportion to _N_ log _N_. Multistage interconnection networks (MINs) were initially proposed for telephone exchanges in the 1950s and have since been used to build the communication backbone for parallel supercomputers, symmetric multiprocessors, multicomputer clusters, and IP router switch fabrics.

> 解决横梁缩放问题的一种常见方法是将大型横梁开关分为几个较小开关的阶段，以使单个通过的方式通过开关织物允许从任何来源达到任何目的地。以这种方式排列的拓扑通常称为_ Multistage 互连网络_或_ Multistage Switch Fabrics_，这些网络通常具有与_n_ log _n_成比例增加的复杂性。最初为 1950 年代的电话交换而提出了多通道互连网络（分钟），此后已用于为并行超级计算机，对称多处理器，多机计算机群集和 IP 路由器开关织物构建通信主链。

![](./media/image616.png)

Figure F.11 Popular centralized switched networks: (a) the crossbar network requires _N_<sup>2</sup> crosspoint switches, shown as black dots; (b) the Omega, a MIN, requires _N_/2 log<sub>2</sub> _N_ switches, shown as vertical rectangles. End node devices are shown as numbered squares (total of eight). Links are unidirectional—data enter at the left and exit out the top or right.

> 图 F.11 流行的集中开关网络：（a）横梁网络需要_n_ <sup> 2 </sup>交叉点开关，显示为黑点；（b）Omega，一个分钟，需要_n_/2 log <sub> 2 </sub> _n_开关，显示为垂直矩形。末端节点设备显示为编号正方形（总计八个）。链接是单向的 -  DATA 在左侧输入并退出顶部或右侧。

The interconnection pattern or patterns between MIN stages are permutations that can be represented mathematically by a set of functions, one for each stage. [Figure F.11(b)](#_bookmark609) shows a well-known MIN topology, the _Omega_, which uses the perfect-shuffle permutation as its interconnection pattern for each stage, followed by exchange switches, giving rise to a _perfect-shuffle exchange_ for each stage. In this example, eight input-output ports are interconnected with three stages of 2 2 switches. It is easy to see that a single pass through the three stages allows any input port to reach any output port. In general, when using _k k_ switches, a MIN with _N_ input-output ports requires at least log*<sub>k</sub> N* stages, each of which contains _N/k_ switches, for a total of _N_/_k_ (log*<sub>k</sub> N*) switches.

> 最小阶段之间的互连模式或模式是可以通过一组函数来表示的置换，每个阶段一个。[图 F.11（b）]（#_ bookmark609）显示了一个众所周知的最小拓扑，即_OMEGA_，它使用完美的 shuffle 置换作为每个阶段的互连模式，然后是交换开关，从而产生了_perfect-每个阶段的洗牌交换_。在此示例中，八个输入输出端口与三个阶段的 2 2 个开关互连。很容易看出，单个通过三个阶段允许任何输入端口到达任何输出端口。通常，当使用_k k_ switches 时，带有_n_输入输出端口的最小值至少需要 log* <sub> k </sub> n *阶段，每个阶段都包含_n/k_ switches，总计_n _/_ k_（log*<sub> k </sub> n*）开关。

Despite their internal structure, MINs can be seen as centralized switch fabrics that have end node devices connected at the network periphery, hence the name _centralized switched network_. From another perspective, MINs can be viewed as interconnecting nodes through a set of switches that may not have any nodes directly connected to them, which gives rise to another popular name for central- ized switched networks—_indirect networks_.

> 尽管具有内部结构，但最小值可以看作是在网络外围连接的结束节点设备的集中式开关织物，因此名称_centralized switched network_。从另一个角度来看，分钟可以通过一组可能没有直接连接到它们的节点的开关来视为互连节点，这导致了中央 ized 交换机网络的另一个流行名称 -  _indirect networks_。

Example Compute the cost of interconnecting 4096 nodes using a single crossbar switch relative to doing so using a MIN built from 2 2, 4 4, and 16 16 switches. Con- sider separately the relative cost of the unidirectional links and the relative cost of the switches. Switch cost is assumed to grow quadratically with the number of input (alternatively, output) ports, _k_, for _k_ × _k_ switches.

> 示例使用单个横梁开关计算相互连接 4096 节点的成本相对于使用 2 2、4 4 和 16 16 16 开关的最小值。分别征服单向链接的相对成本和开关的相对成本。对于_k_×_k_开关的输入数量（替代输出）端口，_k_的输入数（替代输出）端口的数量（替代输出）端口数量四倍地增长。

_Answer_ The switch cost of the network when using a single crossbar is proportional to 4096<sup>2</sup>. The unidirectional link cost is 8192, which accounts for the set of links from the end nodes to the crossbar and also from the crossbar back to the end nodes. When using a MIN with _k k_ switches, the cost of each switch is proportional to _k_<sup>2</sup> but there are 4096/_k_ (log*<sub>k</sub>* 4096) total switches. Likewise, there are (log*<sub>k</sub>* 4096) stages of _N_ unidirectional links per stage from the switches plus _N_ links to the MIN from the end nodes. Therefore, the relative costs of the crossbar with respect to each MIN is given by the following:

> _answer_使用单个横杆时网络的开关成本与 4096 <sup> 2 </sup>成正比。单向链接成本为 8192，它说明了从末端节点到横杆的链接集，也是从横杆到末端节点的链接。当使用_K k_开关的最小值时，每个开关的成本与_K_ <sup> 2 </sup>成比例，但是有 4096/_k_（log* <ub> k </sub>* 4096）总开关。同样，从交换机加上_n_的每个阶段_n_单向链接的阶段（log* <sub> k </sub>* 4096）阶段，从末端节点到最小值。因此，相对于每个分钟的相对成本由以下内容给出：

In all cases, the single crossbar has much higher switch cost than the MINs. The most dramatic reduction in cost comes from the MIN composed from the smallest sized but largest number of switches, but it is interesting to see that the MINs with 2 × 2 and 4 × 4 switches yield the same relative switch cost. The relative link cost of the crossbar is lower than the MINs, but by less than an order of magnitude in all cases. We must keep in mind that end node links are different from switch links in their length and packaging requirements, so they usually have different associ- ated costs. Despite the lower link cost, the crossbar has higher overall relative cost.

> 在所有情况下，单个横梁的开关成本都比分钟高得多。成本最大的降低来自最小但最大数量的开关组成的最小值，但是有趣的是，看到 2×2 和 4×4 开关的最小值产生了相同的相对开关成本。横杆的相对链接成本低于最小值，但在所有情况下，次数少于一个数量级。我们必须记住，最终节点链接与其长度和包装要求中的开关链接不同，因此它们通常具有不同的关联费用。尽管链接成本较低，但横梁的总体相对成本较高。

The reduction in switch cost of MINs comes at the price of performance: con- tention is more likely to occur on network links, thus degrading performance. Con- tention in the form of packets _blocking_ in the network arises due to paths from different sources to different destinations simultaneously sharing one or more links. The amount of contention in the network depends on communication traffic behavior. In the Omega network shown in [Figure F.11(b)](#_bookmark609), for example, a packet from port 0 to port 1 blocks in the first stage of switches while waiting for a packet from port 4 to port 0. In the crossbar, no such blocking occurs as links are not shared among paths to unique destinations. The crossbar, therefore, is _nonblock- ing_. Of course, if two nodes try to send packets to the same destination, there will be blocking at the reception link even for crossbar networks. This is accounted for by the average reception factor parameter (σ) when analyzing performance, as dis- cussed at the end of the previous section.

> 分钟开关成本的降低是以性能的价格出现的：连接更可能在网络链接上发生，从而降低性能。网络中的数据包_Blocking_的形式存在，这是由于从不同来源到不同目的地的路径同时共享一个或多个链接。网络中的争论量取决于通信流量行为。在[图 F.11（b）]（#_ bookmark609）中显示的欧米茄网络中，例如，在交换机的第一阶段，从端口 0 到端口 1 块的数据包等待从端口 4 到端口 0 的数据包。在横梁中，没有这种阻塞发生，因为在通往独特目的地的路径之间没有共享链接。因此，横梁是_nonblock- ing_。当然，如果两个节点试图将数据包发送到同一目的地，那么接收链接即使在横梁网络上也会阻止。在分析性能时，这是由平均接收因子参数（σ）所解释的，如上一节的结尾所述。

To reduce blocking in MINs, extra switches must be added or larger ones need to be used to provide alternative paths from every source to every destination. The first commonly used solution is to add a minimum of log*<sub>k</sub> N* 1 extra switch stages to the MIN in such a way that they mirror the original topology. The resulting net- work is _rearrangeably nonblocking_ as it allows nonconflicting paths among new source-destination pairs to be established, but it also doubles the hop count and could require the paths of some existing communicating pairs to be rearranged under some centralized control. The second solution takes a different approach. Instead of using more switch stages, larger switches—which can be implemented by multiple stages if desired—are used in the middle of two other switch stages in such a way that enough alternative paths through the middle-stage switches allow for nonconflicting paths to be established between the first and last stages. The best-known example of this is the Clos network, which is nonblocking. The multi- path property of the three-stage Clos topology can be recursively applied to the middle-stage switches to reduce the size of all the switches down to 2 2, assum- ing that switches of this size are used in the first and last stages to begin with. What results is a Beneŝ topology consisting of 2(log*<sub>2</sub> N*) 1 stages, which is rearrange- ably nonblocking. [Figure F.12(a)](#_bookmark610) illustrates both topologies, where all switches not in the first and last stages comprise the middle-stage switches (recursively) of the Clos network.

> 为了减少分钟内的阻塞，必须添加额外的开关，否则需要使用较大的开关来提供从每个源到每个目的地的替代路径。第一个常用的解决方案是添加最小的 log* <sub> k </sub> n* 1 额外的开关阶段，以镜像原始拓扑的方式。由此产生的网络是_rangeaealneclancly nonthbrocking_，因为它允许建立新的源用途对之间的非冲突路径，但它也可以使 HOP 计数增加一倍，并且可能需要在某些集中式控制下重新排列一些现有的通信对的路径。第二个解决方案采用不同的方法。与其使用更多的开关阶段，不如在其他两个开关阶段中使用较大的开关（可以通过多个阶段实现），以使得足够的替代路径穿过中阶段的开关允许无关紧要的路径 BE 在第一个和最后一个阶段之间建立。最著名的例子是关闭网络，它是无障碍的。可以将三个阶段关闭拓扑的多路径属性递归地应用于中阶段开关，以将所有开关的大小降低至 2 2，假设在第一个和最后一个和最后一次使用此大小的开关首先。结果是一个好处拓扑，由 2 个（log*<sub> 2 </sub> n*）1 个阶段组成，这是重新排列的非封锁。[图 F.12（a）]（#_ bookmark610）说明了这两个拓扑，其中所有交换机在第一个和最后一个阶段中均不包括关闭网络的中间阶段开关（递归）。

The MINs described so far have unidirectional network links, but bidirectional forms are easily derived from symmetric networks such as the Clos and Beneŝ sim- ply by folding them. The overlapping unidirectional links run in different direc- tions, thus forming bidirectional links, and the overlapping switches merge into a single switch with twice the ports (i.e., 4 4 switch). [Figure F.12(b)](#_bookmark610) shows the resulting folded Beneŝ topology but in this case with the end nodes connected

> 到目前为止所描述的分钟有单向网络链接，但是双向形式很容易从对称网络（例如 CLOS 和 BENES-PLY）折叠来得出。重叠的单向链接以不同的方向运行，从而形成双向链接，而重叠的开关合并为单个开关，端口两倍（即 4 4 个开关）。[图 F.12（b）]（#_ bookmark610）显示了所得的折叠式拓扑，但在这种情况下，连接了末端节点

<img src="./media/image644.png" style="width:2.89968in;height:1.99761in" />
<img src="./media/image645.png" style="width:1.63594in;height:1.97262in" />
<img src="./media/image301.png" style="width:5.97537in" />

Figure F.12 Two Beneŝ networks. (a) A 16-port Clos topology, where the middle-stage switches shown in the darker shading are implemented with another Clos network whose middle-stage switches shown in the lighter shading are implemented with yet another Clos network, and so on, until a Beneŝ network is produced that uses only 2 2 switches everywhere. (b) A folded Beneŝ network (bidirectional) in which 4 4 switches are used; end nodes attach to the innermost set of the Beneŝ network (unidirectional) switches. This topology is equivalent to a fat tree, where tree vertices are shown in shades.

> 图 F.12 两个好处网络。（a）一个 16 端口的闭合拓扑，其中在深色阴影中显示的中间阶段开关与另一个关闭网络实现生产一个 Beneŝ 网络，该网络在各处仅使用 2 2 个开关。（b）使用 4 个 4 个开关的折叠式占地网络（双向）；结束节点附加到最内向的 Beneŝ 网络（单向）开关。该拓扑相当于一棵胖树，其中树顶点以阴影显示。

to the innermost switch stage of the original Beneŝ. Ports remain free at the other side of the network but can be used for later expansion of the network to larger sizes. These kind of networks are referred to as _bidirectional multistage intercon- nection networks._ Among many useful properties of these networks are their mod- ularity and their ability to exploit communication locality, which saves packets from having to hop across all network stages. Their regularity also reduces routing complexity and their multipath property enables traffic to be routed more evenly across network resources and to tolerate faults.

> 到原始 Beneŝ 的最内向开关阶段。端口在网络的另一侧保持免费，但可用于以后将网络扩展到更大的尺寸。这些网络称为_ bidirectional 多阶段互连网络。它们的规律性还降低了路由的复杂性，其多路径属性使流量可以在网络资源之间更均匀地路由并容忍故障。

Another way of deriving bidirectional MINs with nonblocking (rearrangeable) properties is to form a balanced tree, where end node devices occupy leaves of the tree and switches occupy vertices within the tree. Enough links in each tree level must be provided such that the total link bandwidth remains constant across all levels. Also, except for the root, switch ports for each vertex typically grow as _k<sup>i</sup> k<sup>i</sup>_, where _i_ is the tree level. This can be accomplished by using _k<sup>i</sup>_<sup>—1</sup> total switches at each vertex, where each switch has _k_ input and _k_ output ports, or _k_ bidirectional ports (i.e., _k k_ input-output ports). Networks having such topologies are called _fat tree_ networks. As only half of the _k_ bidirectional ports are used in each direction, 2 _N_/_k_ switches are needed in each stage, totaling 2 _N_/_k_ (log<sub>_k_/2</sub> _N_) switches in the fat tree. The number of switches in the root stage can be halved as no forward links are needed, reducing switch count by _N/k_. [Figure F.12(b)](#_bookmark610) shows a fat tree for 4 4 switches. As can be seen, this is identical to the folded Beneŝ.

> 衍生出具有非块（可重新排列）特性的双向分钟的另一种方法是形成平衡的树，其中最终节点设备占据了树的叶子，开关占据了树内的顶点。必须提供每个树级别中的足够链接，以使总链路带宽在所有级别上保持恒定。另外，除根外，每个顶点的切换端口通常以_k <sup> i </sup> k <sup> i </sup> _ _，其中_i_是树级别。这可以通过使用_k <sup> i </sup> _ <sup> _ </sup> —1 </sup>在每个顶点处的总开关，每个交换 k_输入输出端口）。具有此类拓扑结构的网络称为_FAT 树_网络。由于在每个方向上仅使用_k_双向端口的一半，因此每个阶段都需要 2 个_n _/_ k_开关，总计 2 _n _/_ k_（log <sub> _k_/2 </2 </sub> _n_）开关。根阶段的开关数量可以减半，因为不需要正向链接，将开关计数减少_n/k_。[图 F.12（b）]（#_ bookmark610）显示了一个 4 4 个开关的胖树。可以看出，这与折叠的好处相同。

The fat tree is the topology of choice across a wide range of network sizes for most commercial systems that use multistage interconnection networks. Most SANs used in multicomputer clusters, and many used in the most powerful supercomputers, are based on fat trees. Commercial communication subsystems offered by Myrinet, Mellanox, and Quadrics are also built from fat trees.

> 对于大多数使用多阶段互连网络的商业系统，胖树是各种网络尺寸的首选拓扑。多数 SAN 用于多机构群集中，许多 SAN 用于最强大的超级计算机中，都是基于胖树。Myrinet，Mellanox 和 Quadrics 提供的商业通信子系统也是由胖树建造的。

### Distributed Switched Networks

> ###分布式交换网络

Switched-media networks provide a very flexible framework to design communi- cation subsystems external to the devices that need to communicate, as presented above. However, there are cases where it is convenient to more tightly integrate the end node devices with the network resources used to enable them to communicate. Instead of centralizing the switch fabric in an external subsystem, an alternative approach is to distribute the network switches among the end nodes, which then become _network nodes_ or simply _nodes_, yielding a _distributed switched network_. As a consequence, each network switch has one or more end node devices directly connected to it, thus forming a network node. These nodes are directly connected to other nodes without indirectly going through some external switch, giving rise to another popular name for these networks—_direct networks_.

> Switched-Media 网络提供了一个非常灵活的框架，可以设计在需要通信的设备外部设计的通信子系统，如上所述。但是，在某些情况下，更方便地将最终节点设备与用于使其通信的网络资源更加紧密地集成在一起。另一种方法是将网络交换机分配到末端节点之间，然后将其变为_network nodes_或简单的_nodes_，而不是集中开关结构，而是将网络交换机分配到末端节点之间，从而产生_Distribed switched network_。结果，每个网络交换机都有一个或多个直接连接到它的末端节点设备，从而形成网络节点。这些节点直接连接到其他节点，而无需间接地通过某些外部开关，从而为这些网络提供了另一个流行名称-Direct Networks_。

The topology for distributed switched networks takes on a form much differ- ent from centralized switched networks in that end nodes are connected across the area of the switch fabric, not just at one or two of the peripheral edges of the fabric. This causes the number of switches in the system to be equal to the total number of nodes. A quite obvious way of interconnecting nodes consists of connecting a dedicated link between each node and every other node in the network. This _fully connected_ topology provides the best connectivity (full con- nectivity in fact), but it is more costly than a crossbar network, as the following example shows.

> 分布式开关网络的拓扑采用与集中式开关网络有很大不同的形式，在该末端节点在开关织物的区域之间连接，而不仅仅是织物的外围边缘之一。这导致系统中的开关数量等于节点总数。互连节点互连的一种非常明显的方法是连接每个节点与网络中其他节点之间的专用链接。此_ connected_拓扑提供了最佳的连接性（实际上是完全连接性），但是如下示例所示，它比横梁网络更为昂贵。

Example Compute the cost of interconnecting _N_ nodes using a fully connected topology rel- ative to doing so using a crossbar topology. Consider separately the relative cost of the unidirectional links and the relative cost of the switches. Switch cost is assumed to grow quadratically with the number of unidirectional ports for _k_ × _k_ switches but to grow only linearly with 1 × _k_ switches.

> 示例使用完全连接的拓扑结合使用横梁拓扑来计算互连_n_节点的成本。单独考虑单向链接的相对成本和开关的相对成本。假定开关成本与_K_×_K_开关的单向端口数量相互缩写，但仅用 1×_K_开关线性生长。

_Answer_ The crossbar topology requires an _N N_ switch, so the switch cost is proportional to _N_<sup>2</sup>. The link cost is 2*N*, which accounts for the unidirectional links from the end nodes to the centralized crossbar, and _vice versa_. In the fully connected topology, two sets of 1 (_N_ 1) switches (possibly merged into one set) are used in each of the _N_ nodes to connect nodes directly to and from all other nodes. Thus, the total switch cost for all _N_ nodes is proportional to 2*N*(_N_ 1). Regarding link cost, each of the _N_ nodes requires two unidirectional links in opposite directions between its end node device and its local switch. In addition, each of the _N_ nodes has _N_ 1 unidirectional links from its local switch to other switches distributed across all the other end nodes. Thus, the total number of unidirectional links is 2*N* +_N_(_N_ 1), which is equal to _N_(_N_ + 1) for all _N_ nodes. The relative costs of the fully connected topology with respect to the crossbar is, therefore, the following:

> _answer _横梁拓扑需要_n n_开关，因此开关成本与_n_ <sup> 2 </sup>成正比。链接成本为 2*n*，它说明了从末端节点到集中式横杆的单向链接，_vice versa_。在完全连接的拓扑结构中，在每个_n_节点中使用了两组 1（_n_ 1）开关（可能合并为一组），以直接连接到与所有其他节点的节点。因此，所有_n_节点的总开关成本与 2*n*（_ n_ 1）成正比。关于链接成本，每个_n_节点都需要在其最终节点设备和本地开关之间相反的方向上两个单向链接。此外，每个_n_节点都有_n_ 1 的单向链接，从其本地开关到分布在所有其他末端节点上的其他开关。因此，单向链接的总数为 2* n* + _n _（_ n_ 1），对于所有_n_节点，它等于_n _（_ n_ + 1）。因此，完全连接的拓扑相对于横杆的相对成本是以下内容：

As the number of interconnected devices increases, the switch cost of the fully connected topology is nearly double the crossbar, with both being very high (i.e., quadratic growth). Moreover, the fully connected topology always has higher relative link cost, which grows linearly with the number of nodes. Again, keep in mind that end node links are different from switch links in their length and pack- aging, particularly for direct networks, so they usually have different associated costs. Despite its higher cost, the fully connected topology provides no extra per- formance benefits over the crossbar as both are nonblocking. Thus, crossbar net- works are usually used in practice instead of fully connected networks.

> 随着互连设备的数量增加，完全连接的拓扑的开关成本几乎是横杆的两倍，两者都非常高（即二次增长）。此外，完全连接的拓扑始终具有较高的相对链接成本，它随节点数量线性增长。同样，请记住，最终节点链接与其长度和包装中的开关链接不同，尤其是对于直接网络，因此它们通常具有不同的相关成本。尽管成本较高，但完全连接的拓扑并没有对横杆提供额外的效果，因为两者都不封锁。因此，横杆网通常用于实践而不是完全连接的网络。

A lower-cost alternative to fully connecting all nodes in the network is to directly connect nodes in sequence along a _ring_ topology, as shown in [Figure F.13](#_bookmark611). For bidirectional rings, each of the _N_ nodes now uses only 3 3 switches and just two bidirectional network links (shared by neighboring nodes), for a total of _N_ switches and _N_ bidirectional network links. This linear cost excludes the _N_ injection-reception bidirectional links required within nodes.

> 完全连接网络中所有节点的较低成本替代方案是直接沿_ring_拓扑的序列连接节点，如[图 F.13]（#_ bookmark611）所示。对于双向戒指，现在每个_n_节点都只使用 3 个 3 个开关和两个双向网络链接（相邻节点共享），总共_n_开关和_n_双向网络链接。该线性成本不包括_n_ indection-rection-topection 双向链接。

Unlike shared-media networks, rings can allow many simultaneous transfers: the first node can send to the second while the second sends to the third, and so on. However, as dedicated links do not exist between logically nonadjacent node pairs, packets must hop across intermediate nodes before arriving at their destination, increasing their transport latency. For bidirectional rings, packets can be trans- ported in either direction, with the shortest path to the destination usually being the one selected. In this case, packets must travel _N_/4 network switch hops, on average, with total switch hop count being one more to account for the local switch at the packet source node. Along the way, packets may block on network resources due to other packets contending for the same resources simultaneously.

> 与共享媒体网络不同，戒指可以允许许多同时转移：第一个节点可以发送到第二个，而第二个节点则发送到第三个节点，依此类推。但是，由于在逻辑上非附属节点对之间不存在专用链接，因此数据包必须在到达目的地之前跨中间节点跳跃，从而增加了运输延迟。对于双向环，可以将数据包沿任一方向进行转移，而通往目的地的最短路径通常是所选的。在这种情况下，数据包必须平均行驶_n_/4 网络开关啤酒花，而总开关跳跃计数是一个可以考虑到数据包源节点处的本地开关的又一个。一路上，由于其他数据包同时争夺相同资源，数据包可能会阻止网络资源。

Fully connected and ring-connected networks delimit the two extremes of dis- tributed switched topologies, but there are many points of interest in between for a given set of cost-performance requirements. Generally speaking, the ideal switched-media topology has cost approaching that of a ring but performance approaching that of a fully connected topology. [Figure F.14](#_bookmark612) illustrates three pop- ular direct network topologies commonly used in systems spanning the cost- performance spectrum. All of them consist of sets of nodes arranged along multiple dimensions with a regular interconnection pattern among nodes that can be expressed mathematically. In the _mesh_ or _grid_ topology, all the nodes in each dimension form a linear array. In the _torus_ topology, all the nodes in each dimen- sion form a ring. Both of these topologies provide direct communication to neigh- boring nodes with the aim of reducing the number of hops suffered by packets in the network with respect to the ring. This is achieved by providing greater connec- tivity through additional dimensions, typically no more than three in commercial systems. The _hypercube_ or _n-cube_ topology is a particular case of the mesh in which only two nodes are interconnected along each dimension, leading to a num- ber of dimensions, _n_, that must be large enough to interconnect all _N_ nodes in the system (i.e., _n_ =log<sub>2</sub> _N_). The hypercube provides better connectivity than meshes and tori at the expense of higher link and switch costs, in terms of the number of links and number of ports per node.

> 完全连接和与环连接的网络界定了两个极端的分离切换拓扑，但是对于给定的一组成本绩效要求，两者之间有很多兴趣。一般而言，理想的切换媒体拓扑的成本接近了环，但性能接近完全连接的拓扑。[图 F.14]（#_ bookmark612）说明了跨越成本性能频谱的系统中常用的三个流行直接网络拓扑。所有这些都由沿多个维度排列的一组节点组成，并在节点之间具有常规互连模式，这些节点可以用数学表达。在_mesh_或_grid_拓扑中，每个维度中的所有节点构成线性阵列。在_torus_拓扑结构中，每个尺寸中的所有节点构成一个环。这两种拓扑都提供了与邻居节点的直接通信，目的是减少网络中数据包在环中相对于环的啤酒花数量。这是通过通过其他维度提供更大的联系来实现的，通常在商业系统中不超过三个。_hyperCube_或_n-cube_拓扑是网格的一种特殊情况，在每个维度上，只有两个节点沿每个维度互连，从而导致一个尺寸_n_，必须足够大才能互连系统中的所有_n_节点（即，_n_ = log <sub> 2 </sub> _n_）。HyperCube 提供的连通性比网格和 Tori 提供更好的连接性，而限制了链接和开关成本，而链接数量和每个节点的端口数量。

![](./media/image646.png)

Figure F.13 A ring network topology, folded to reduce the length of the longest link. Shaded circles represent switches, and black squares represent end node devices. The gray rectangle signifies a network node consisting of a switch, a device, and its connecting link.

> 图 F.13 环网拓扑，折叠以减少最长链接的长度。阴影圆表示开关，而黑色正方形表示末端节点设备。灰色矩形表示由开关，设备及其连接链接组成的网络节点。

Figure F.14 Direct network topologies that have appeared in commercial systems, mostly supercomputers.

> 图 F.14 出现在商业系统（主要是超级计算机）中的直接网络拓扑。

The shaded circles represent switches, and the black squares represent end node devices. Switches have many bidirectional network links, but at least one link goes to the end node device. These basic topologies can be supplemented with extra links to improve performance and reliability. For example, connecting the switches on the periphery of the 2D mesh, shown in (a), using the unused ports on each switch forms a 2D torus, shown in (b). The hypercube topology, shown in (c) is an _n_-dimensional inter- connect for 2*<sup>n</sup>* nodes, requiring _n_ + 1 ports per switch: one for the _n_ nearest neighbor nodes and one for the end node device.

> 阴影圆表示开关，而黑色正方形表示末端节点设备。开关具有许多双向网络链接，但是至少一个链接进入了最终节点设备。这些基本拓扑可以补充额外的链接，以提高性能和可靠性。例如，使用每个开关上的未使用端口形成一个 2D 圆圈，将 2D 网格周围的开关连接在（a）中所示，如（b）所示。（c）中显示的超立方体拓扑是一个_n_-dimensional Inter-连接 2* <sup> n </sup>*节点，需要_n_ + 1 个端口：一个用于_n_最近的邻居节点，一个用于_n_结束节点设备。

Example Compute the cost of interconnecting _N_ devices using a torus topology relative to doing so using a fat tree topology. Consider separately the relative cost of the bidi- rectional links and the relative cost of the switches—which is assumed to grow quadratically with the number of bidirectional ports. Provide an approximate expression for the case of switches being similar in size.

> 示例使用圆环拓扑来计算互连_n_设备的成本，相对于使用脂肪树拓扑结构。单独考虑双向链接的相对成本和开关的相对成本，假定会随着双向端口的数量四次增长。为开关大小相似的情况提供了大致的表达。

_Answer_ Using _k k_ switches, the fat tree requires 2 _N_/_k_ (log<sub>_k_/2</sub> _N_) switches, assuming the last stage (the root) has the same number of switches as each of the other stages. Given that the number of bidirectional ports in each switch is _k_ (i.e., there are _k_ input ports and _k_ output ports for a _k k_ switch) and that the switch cost grows quadratically with this, total network switch cost is proportional to 2*kN* log<sub>_k_/2</sub>

> _answer _使用_k k_ switches，脂肪树需要 2 _n _/_ k_（log <sub> _k_/2 </sub> _n_）开关，假设最后一个阶段（根）具有与其他每个阶段相同的交换机数。鉴于每个交换机中的双向端口数为_k_（即，有_k_输入端口和_k_输出端口的_k k_ k_ switch），并且交换机的成本与此相关，整个网络开关成本与 2*kn 相对比例。* log <sub> _K_/2 </sub>

_N_. The link cost is _N_ log<sub>_k_/2</sub> _N_ as each of the log<sub>_k_/2</sub> _N_ stages requires _N_ bidirectional links, including those between the devices and the fat tree. The torus requires as many switches as nodes, each of them having 2*n* + 1 bidirectional ports, including the port to attach the communicating device, where _n_ is the number of dimensions. Hence, total switch cost for the torus is (2*n* + 1)<sup>2</sup>_N_. Each of the torus nodes requires 2*n* + 1 bidirectional links for the _n_ different dimensions and the connection for its end node device, but as the dimensional links are shared by two nodes, the total number of links is (2*n*/2 + 1)_N_ (_n_ + 1)_N_ bidirectional links for all _N_ nodes. Thus, the relative costs of the torus topology with respect to the fat tree are

> _n_。链接成本为_n_ log <sub> _k_/2 </sub> _n_作为日志<sub> _k_/2 </sub> _n_阶段中的每个 nok <sub> _k_/2 阶段需要_n_双向链接，包括设备和脂肪树之间的链接。圆环需要与节点一样多的开关，每个开关都具有 2* n* + 1 双向端口，包括连接通信设备的端口，其中_n_是尺寸的数量。因此，圆环的总开关成本为（2* n* + 1）<sup> 2 </sup> _n_。每个圆环节点都需要 2*n* + 1 的双向链接，_n_不同的尺寸和其末端节点设备的连接，但是由于尺寸链接由两个节点共享，因此链接的总数为（2*n*/2 + 1）_n_（_n_ + 1）_n_ bidirectional 链接所有_n_节点。因此，关于胖树的圆环拓扑的相对成本是

Relative cost*<sub>switches</sub>* = (2*n* + 1)2*N*/2*kN* log <sub>_k_/2</sub> _N_ = (2*n* + 1)2/2*k* log <sub>_k_/2</sub> _N_

> 相对费用*<sub> switches </sub>*=（2*n* + 1）2*n*/2*kn*log <sub> _k_/2 </sub> _n_ =（2*n* + 1）2/2* k* log <sub> _k_/2 </sub> _n_

Relative cost*<sub>links</sub>* = (_n_ + 1)_N_/_N_ log <sub>_k_/2</sub> _N_ = (_n_ + 1)/ log <sub>_k_/2</sub> _N_

> 相对费用* <sub>链接</sub>* =（_n_ + 1）_n _/_ n _ n _ log <sub> _k _/2 </sub> _n_ =（_n_ + 1）/log <sub> _k_/2 </2 </2 </sub sub sub> _n_

When switch sizes are similar, 2*n* +1 ﬃ _k_. In this case, the relative cost is

> 当开关尺寸相似时，2* n* +1 unf_k_。在这种情况下，相对成本是

Relative cost*<sub>switches</sub>* = (2*n* + 1) /2*k* log <sub>_k_/2</sub> _N_ = (2*n* + 1)/2 log <sub>_k_/2</sub> _N_ = _k_/2 log <sub>_k_/2</sub> _N_

> 相对费用* <sub> switches </sub>* =（2* n* + 1）/2* k* log <sub> _k_/2 </sub> _n_ =（2* n* + 1）/2 log<sub> _k_/2 </sub> _n_ = _k_/2 log <sub> _k_/2 </sub> _n_

When the number of switch ports (also called _switch degree_) is small, tori have lower cost, particularly when the number of dimensions is low. This is an espe- cially useful property when _N_ is large. On the other hand, when larger switches and/or a high number of tori dimensions are used, fat trees are less costly and pref- erable. For example, when interconnecting 256 nodes, a fat tree is four times more expensive in terms of switch and link costs when 4 4 switches are used. This higher cost is compensated for by lower network contention, on average. The fat tree is comparable in cost to the torus when 8 8 switches are used (e.g., for interconnecting 256 nodes). For larger switch sizes beyond this, the torus costs more than the fat tree as each node includes a switch. This cost can be amortized by connecting multiple end node devices per switch, called _bristling_.

> 当开关端口的数量（也称为_switch deger_）的数量很小时，托里的成本较低，尤其是当尺寸较低时。当_n_大时，这是一个尤其有用的属性。另一方面，当使用较大的开关和/或大量的圆锥形尺寸时，脂肪树的成本较小且偏爱。例如，当互连 256 个节点时，当使用 4 个 4 开关时，胖树的开关和链接成本贵四倍。平均而言，较低的网络争夺可以补偿这种较高的成本。当使用 8 8 个开关时（例如，用于互连 256 个节点），脂肪树的成本与圆环相当。对于除此之外的较大开关尺寸，由于每个节点都包含一个开关，因此圆环的成本比脂肪树高。可以通过连接每个开关的多个端节点设备，称为_bristling_来摊销此成本。

The topologies depicted in [Figure F.14](#_bookmark612) all have in common the interesting characteristic of having their network links arranged in several orthogonal dimensions in a regular way. In fact, these topologies all happen to be particular instances of a larger class of direct network topologies known as _k_-ary _n_-cubes, where _k_ signifies the number of nodes interconnected in each of the _n_ dimen- sions. The symmetry and regularity of these topologies simplify network imple- mentation (i.e, packaging) and packet routing as the movement of a packet along a given network dimension does not modify the number of remain- ing hops in any other dimension toward its destination. As we will see in the next section, this topological property can be readily exploited by simple rout- ing algorithms.

> [图 F.14]（#_ bookmark612）中描述的拓扑都具有一个有趣的特征，即以常规方式将其网络链接以几个正交维度排列。实际上，这些拓扑都恰好是较大类的直接网络拓扑的特殊实例，称为_k_-ary _n_-cubes，其中_k_表示在每个_n_ dimensions 中互连的节点的数量。这些拓扑的对称性和规律性简化了网络的影响（即包装）和数据包路由，因为数据包沿给定的网络维度的移动不会改变任何其他维度在其目的地的其他维度的剩余啤酒花数量。正如我们将在下一部分中看到的那样，可以通过简单的途径很容易利用此拓扑属性。

Like their indirect counterpart, direct networks can introduce blocking among packets that concurrently request the same path, or part of it. The only exception is fully connected networks. The same way that the number of stages and switch hops in indirect networks can be reduced by using larger switches, the hop count in direct networks can likewise be reduced by increasing the number of topological dimensions via increased switch degree.

> 像他们的间接对应物一样，直接网络可以在同时要求相同路径或部分路径的数据包之间引入阻止。唯一的例外是完全连接的网络。通过使用较大的开关可以减少间接网络中的阶段和开关跃点的数量，直接网络中的 HOP 计数也可以通过增加开关度量来减少拓扑维度的数量来减少。

It may seem to be a good idea always to maximize the number of dimen- sions for a system of a certain size and switch cost. However, this is not nec- essarily the case. Most electronic systems are built within our three-dimensional (3D) world using planar (2D) packaging technology such as integrated circuit chips, printed circuit boards, and backplanes. Direct networks with up to three dimensions can be implemented using relatively short links within this 3D space, independent of system size. Links in higher-dimensioned networks would require increasingly longer wires or fiber. This increase in link length with system size is also indicative of MINs, including fat trees, which require either long links within all the stages or increasingly longer links as more stages are added. As we saw in the first example given in [Section F.2](#interconnecting-two-devices), flow-controlled buffers increase in size proportionally to link length, thus requiring greater sil- icon area. This is among the reasons why the supercomputer with the largest number of compute nodes existing in 2005, the IBM Blue Gene/L, implemented a 3D torus network for interprocessor communication. A fat tree would have required much longer links, rendering a 64K node system less feasible. This highlights the importance of correctly selecting the proper network topology that meets system requirements.

> 最大化一定尺寸和开关成本系统的尺寸数量似乎总是一个好主意。但是，实际上并不是必需的情况。大多数电子系统都使用平面（2D）包装技术（例如集成电路芯片，印刷电路板和背板）构建在我们的三维（3D）世界内。可以使用此 3D 空间中相对较短的链接（独立于系统大小）内实现具有多达三个维度的直接网络。较高尺寸的网络中的链接将需要越来越长的电线或光纤。与系统尺寸的链路长度的增加也表示分钟，包括脂肪树，这些阶段需要长时间的链接，或者在添加更多阶段时越来越长的链接。正如我们在[F.2]节（＃互连两个设备）中给出的第一个示例中看到的那样，流量控制的缓冲区的大小与链接长度成比例地增加，因此需要更大的 Sil-Icon 区域。这就是为什么 2005 年存在的计算节点数量最多的超级计算机（IBM Blue Gene/L）实现了一个用于解释器通信的 3D 圆环网络。一棵胖树需要更长的链接，使 64K 节点系统较不可行。这突出了正确选择满足系统要求的正确网络拓扑的重要性。

Besides link length, other constraints derived from implementing the topology may also limit the degree to which a topology can scale. These are available _pin-out_ and achievable _bisection bandwidth_. Pin count is a local restriction on the band- width of a chip, printed circuit board, and backplane (or chassis) connector. In a direct network that integrates processor cores and switches on a single chip or multichip module, pin bandwidth is used both for interfacing with main memory and for implementing node links. In this case, limited pin count could reduce the number of switch ports or bit lines per link. In an indirect network, switches are implemented separately from processor cores, allowing most of the pins to be ded- icated to communication bandwidth. However, as switches are grouped onto boards, the aggregate of all input-output links of the switch fabric on a board for a given topology must not exceed the board connector pin-outs.

> 除了链接长度外，实施拓扑而得出的其他约束也可能限制拓扑扩展的程度。这些可用_pin-out_和可实现的_bisection 带宽_。引脚计数是对芯片，印刷电路板和背板（或机箱）连接器的局部限制。在集成了单个芯片或多芯片模块上的处理器内核和开关的直接网络中，PIN 带宽都用于与主内存和实现节点链接进行连接。在这种情况下，有限的 PIN 计数可以减少每个链接的开关端口或位线的数量。在间接网络中，开关与处理器内核分开实现，从而使大多数引脚都可以推迟到通信带宽。但是，随着开关分组到板上，给定拓扑的板上开关织物的所有输入输出链接的总计不得超过板连接器引脚。

The bisection bandwidth is a more global restriction that gives the interconnect density and bandwidth that can be achieved by a given implementation (packaging) technology. Interconnect density and clock frequency are related to each other: When wires are packed closer together, crosstalk and parasitic capac- itance increase, which usually impose a lower clock frequency. For example, the availability and spacing of metal layers limit wire density and frequency of on-chip networks, and copper track density limits wire density and frequency on a printed circuit board. To be implementable, the topology of a network must not exceed the available bisection bandwidth of the implementation technology. Most networks implemented to date are constrained more so by pin-out limitations rather than bisection bandwidth, particularly with the recent move to blade-based systems. Nevertheless, bisection bandwidth largely affects performance.

> 二等带宽是一个更全球的限制，可以通过给定的实现（包装）技术实现互连密度和带宽。互连密度和时钟频率彼此相关：当电线靠近封闭时，串扰和寄生能力增加，通常会施加较低的时钟频率。例如，金属层的可用性和间距限制了芯片网络的电线密度和频率，并且铜轨道密度限制了印刷电路板上的电线密度和频率。为了实现，网络的拓扑不得超过实施技术的可用二等带宽。迄今为止，大多数实施的网络都受到限制的限制而不是二等带宽的限制，尤其是最近移至基于刀片的系统。然而，一分为二的带宽在很大程度上影响了性能。

For a given topology, bisection bandwidth, BW<sub>Bisection</sub>, is calculated by dividing the network into two roughly equal parts—each with half the nodes—and summing the bandwidth of the links crossing the imaginary divid- ing line. For nonsymmetric topologies, bisection bandwidth is the smallest of all pairs of equal-sized divisions of the network. For a fully connected network, the bisection bandwidth is proportional to _N_<sup>2</sup>/2 unidirectional links (or _N_<sup>2</sup>/4 bidi- rectional links), where _N_ is the number of nodes. For a bus, bisection bandwidth is the bandwidth of just the one shared half-duplex link. For other topologies, values lie in between these two extremes. Network injection and reception bisection bandwidth is commonly used as a reference value, which is _N_/2 for a network with _N_ injection and reception links, respectively. Any network topology that provides this bisection bandwidth is said to have _full bisection bandwidth._

> 对于给定的拓扑，通过将网络分为两个大致相等的部分（每个有一半的节点）来计算得分，bw <sub>一分为 cection </sub> </sub> </sub> </sub>，并求和跨越虚线的链路带宽。对于非对称拓扑结构，一分为二的带宽是网络相等大小的所有对组中最小的。对于完全连接的网络，二级带宽与_n_ <sup> 2 </sup>/2 单向链接成正比（或_n_ <sup> 2 </sup>/4 bidi-ection-ection-ectional 链接），其中_n_是_n_节点。对于公共汽车，二等带宽是一个共享半双链链路的带宽。对于其他拓扑，值在这两个极端之间。网络注入和接收一分配带宽通常用作参考值，对于具有_n_注入和接收链路的网络，它为_n_/2。据说提供此一分配带宽的任何网络拓扑都具有_full Bisection 带宽。

Figure F.15 summarizes the number of switches and links required, the corre- sponding switch size, the maximum and average switch hop distances between nodes, and the bisection bandwidth in terms of links for several topologies discussed in this section for interconnecting 64 nodes.

> 图 F.15 总结了所需的开关和链接的数量，相关开关的大小，节点之间的最大和平均开关跃距以及本节中讨论的几个拓扑的链接，以互连 64 个节点。

Figure F.15 Performance and cost of several network topologies for 64 nodes. The bus is the standard reference at unit network link cost and bisection bandwidth. Values are given in terms of bidirectional links and ports. Hop count includes a switch and its output link, but not the injection link at end nodes. Except for the bus, values are given for the number of network links and total number of links, including injection/reception links between end node devices and the network.

> 图 F.15 64 个节点的几个网络拓扑的性能和成本。公共汽车是单位网络链路成本和一分配带宽处的标准参考。值是根据双向链接和端口给出的。Hop Count 包括一个开关及其输出链接，但不包括末端节点处的注入链接。除了总线外，还为网络链接的数量和链接总数提供了值，包括 End Node 设备和网络之间的注入/接收链接。

### Effects of Topology on Network Performance

> ###拓扑对网络性能的影响

Switched network topologies require packets to take one or more hops to reach their destination, where each hop represents the transport of a packet through a switch and one of its corresponding links. Interestingly, each switch and its corre- sponding links can be modeled as a black box network connecting more than two devices, as was described in the previous section, where the term “devices” here refers to end nodes or other switches. The only differences are that the sending and receiving overheads are null through the switches, and the routing, switching, and arbitration delays are not cumulative but, instead, are delays associated with each switch.

> 开关网络拓扑要求数据包采用一个或多个啤酒花以达到其目的地，每个跳跃代表通过开关和其相应链接之一将数据包传输。有趣的是，可以将每个开关及其共同链接建模为连接两个以上设备的黑匣子网络，如上一节所述，此处的“设备”一词是指结束节点或其他开关。唯一的区别是，发送和接收开销是通过交换机为无效的，并且路由，开关和仲裁延迟不是累积的，而是与每个交换机关联的延迟。

As a consequence of the above, if the average packet has to traverse _d_ hops to its destination, then _T_<sub>R</sub> + _T_<sub>A</sub> + _T_<sub>S</sub> (_T_<sub>r</sub> + _T_<sub>a</sub> + _T_<sub>s</sub>) _d,_ where _T_<sub>r</sub>, _T_<sub>a</sub>, and _T_<sub>s</sub> are the routing, arbitration, and switching delays, respectively, of a switch. With the assumption that pipelining over the network is staged on each hop at the packet level (this assumption will be challenged in the next section), the transmission delay is also increased by a factor of the number of hops. Finally, with the simpli- fying assumption that all injection links to the first switch or stage of switches and all links (including reception links) from the switches have approximately the same length and delay, the total propagation delay through the network _T_<sub>TotalProp</sub> is the propagation delay through a single link, _T_<sub>LinkProp</sub>, multiplied by _d_ + 1, which is the hop count plus one to account for the injection link. Thus, the best-case lower- bound expression for average packet latency in the network (i.e., the latency in the absence of contention) is given by the following expression:

> 由于上述结果，如果平均数据包必须遍历其目的地，则_t_ <sub> r </sub> + _t_t_ <sub> a </sub> + _t_t_ <sub> s </sub> s </sub>（_t_ <sub> r </sub> + _t_t_ <sub> a </sub> + _t_t_ <sub> s </sub>）</sub>，和_t_ <sub> s </sub>分别是开关的路由，仲裁和切换延迟。假设在数据包级别的每个跳跃上上演了网络上的管道上的启用（在下一节中会挑战此假设），传输延迟也增加了啤酒花数量的一定数。最后，通过简化的假设，即所有注射链接链接到开关的第一个开关或阶段以及来自开关的所有链接（包括接收链接）的长度和延迟大致相同，总传播延迟了网络_t_ <ub>>TotalProp </sub>是通过单个链接的传播延迟，_t_ <sub> linkprop </sub>，乘以_d_ + 1，这是啤酒花计数加上一个用于说明注入链接的一个。因此，通过以下表达式给出了网络中平均数据包延迟的最佳较低界表达（即，在没有争夺的情况下的潜伏期）：

Again, the expression on page F-40 assumes that switches are able to pipeline packet transmission at the packet level.

> 同样，F-40 页上的表达式假设开关能够在数据包级别输送数据包传输。

Following the method presented previously, we can estimate the best-case upper bound for effective bandwidth by finding the narrowest section of the end-to-end network pipe. Focusing on the internal network portion of that pipe, network bandwidth is determined by the blocking properties of the topology. Non-blocking behavior can be achieved only by providing many alternative paths between every source-destination pair, leading to an aggregate network bandwidth that is many times higher than the aggregate network injection or reception band- width. This is quite costly. As this solution usually is prohibitively expensive, most networks have different degrees of blocking, which reduces the utilization of the aggregate bandwidth provided by the topology. This, too, is costly but not in terms of performance.

> 遵循前面介绍的方法，我们可以通过找到端到端网络管道的最狭窄部分来估计有效带宽的最佳案例上限。关注该管道的内部网络部分，网络带宽取决于拓扑的阻止属性。只有通过在每个源用途对之间提供许多替代路径才能实现非阻滞行为，从而导致骨料网络带宽比聚集网络注入或接收频带宽度高很多倍。这很昂贵。由于该解决方案通常非常昂贵，因此大多数网络都具有不同程度的阻塞，从而降低了拓扑提供的总带宽的利用。这也是昂贵的，但就性能而言不是。

The amount of blocking in a network depends on its topology and the traffic distribution. Assuming the bisection bandwidth, BW<sub>Bisection</sub>, of a topology is implementable (as typically is the case), it can be used as a constant measure of the maximum degree of blocking in a network. In the ideal case, the network always achieves full bisection bandwidth irrespective of the traffic behavior, thus transferring the bottlenecking point to the injection or reception links. However, as packets destined to locations in the other half of the network necessarily must cross the bisection links, those links pose as potential bottleneck links—potentially reducing the network bandwidth to below full bisection bandwidth. Fortunately, not all of the traffic must cross the network bisection, allowing more of the aggre- gate network bandwidth provided by the topology to be utilized. Also, network topologies with a higher number of bisection links tend to have less blocking as more alternative paths are possible to reach destinations and, hence, a higher per- centage of the aggregate network bandwidth can be utilized. If only a fraction of the traffic must cross the network bisection, as captured by a _bisection traffic fraction_ parameter γ (0 &lt;γ 1), the network pipe at the bisection is, effectively, widened by the reciprocal of that fraction, assuming a traffic distribution that loads the bisection links at least as heavily, on average, as other network links. This defines the upper limit on achievable network bandwidth, BW<sub>Network</sub>:

> 网络中的阻塞数量取决于其拓扑和流量分布。假设可以实现拓扑结构的二分线带宽，BW <sub> bisection </sub>是可以实现的（通常是这种情况），则可以用作网络中最大阻止程度的恒定度量。在理想情况下，无论交通行为如何，网络始终可以实现完全的一分配带宽，从而将瓶颈点传递到注入或接收链接。但是，由于要注定要到网络另一半的位置的数据包必须跨越二分线链接，因此这些链接构成了潜在的瓶颈链接，将网络带宽降低到满分的两分之二带宽以下。幸运的是，并非所有的流量都必须跨越网络二进制，从而允许使用拓扑提供的更多集合网络带宽。同样，由于更多的替代路径可以到达目的地，因此具有更高数量的一分解链路的网络拓扑往往具有较小的阻塞，因此可以利用较高的总体网络带宽。如果只有一小部分流量必须跨越网络二分准，则由_bisection 流量分流_参数 γ（0＆lt;γ1）捕获，则该分数的二分位管道有效地扩大了该分数的倒数流量分布至少像其他网络链接一样至少与其他网络链接一样严重。这定义了可实现的网络带宽的上限，BW <sub>网络</sub>：

It is important to note that γ depends heavily on the traffic patterns generated by applications. It is a measured quantity or calculated from detailed traffic analysis.

> 重要的是要注意，γ 在很大程度上取决于应用程序生成的流量模式。它是测量的数量或根据详细的流量分析计算得出的。

Example A common communication pattern in scientific programs is to have nearest neigh- bor elements of a two-dimensional array to communicate in a given direction. This pattern is sometimes called _NEWS communication_, standing for north, east, west, and south—the directions on a compass. Map an 8 8 array of elements one-to- one onto 64 end node devices interconnected in the following topologies: bus, ring, 2D mesh, 2D torus, hypercube, fully connected, and fat tree. How long does it take in the best case for each node to send one message to its northern neighbor and one to its eastern neighbor, assuming packets are allowed to use any minimal path pro- vided by the topology? What is the corresponding effective bandwidth? Ignore ele- ments that have no northern or eastern neighbors. To simplify the analysis, assume that all networks experience unit packet transport time for each network hop—that is, _T_<sub>LinkProp</sub>, _T_<sub>r</sub>, _T_<sub>a</sub>, _T_<sub>s</sub>, and packet transmission time for each hop sum to one. Also assume the delay through injection links is included in this unit time, and sending/ receiving overhead is null.

> 示例科学程序中的一种常见沟通模式是，要具有二维阵列的最近的邻居要素，以朝给定的方向进行交流。这种模式有时称为_news communication_，代表北，东，西部和南方，这是指南针的方向。将一个 8 8 个元素一到一个元素映射到以下拓扑中互连的 64 个末端节点设备：总线，环，2D 网格，2D 圆环，2D 圆环，超立方体，完全连接和脂肪树。假设允许包数据包使用拓扑结构的任何最小路径，则每个节点在每个节点的最佳情况下要花费多长时间？什么是相应的有效带宽？忽略没有北部或东方邻居的元素。为了简化分析，假设所有网络都会体验每个网络的单位数据包运输时间，即_t_t_ <ub> linkprop </sub>，_t_t_ <ub> r </sub>，_t_t_ <sub> a </sub a </sub>，_t_ <sub> s </sub>，以及每个跳跃总和的数据包传输时间。另外，假设通过注射链接的延迟包含在此单元时间中，并且发送/接收开销为无效。

_Answer_ This communication pattern requires us to send 2 (64 8) or 112 total packets— that is, 56 packets in each of the two communication phases: northward and east- ward. The number of hops suffered by packets depends on the topology. Commu- nication between sources and destinations are one-to-one, so σ is 100%.

> _answer_这种通信模式要求我们发送 2（64 8）或 112 个总包，也就是说，在两个通信阶段中的每个阶段中的每个数据包：北向和东部。数据包遭受的啤酒花数取决于拓扑。来源和目的地之间的交流是一对一的，因此 σ 为 100％。

The injection and reception bandwidth cap the effective bandwidth to a maximum of 64 BW units (even though the communication pattern requires only 56 BW units). However, this maximum may get scaled down by the achievable network bandwidth, which is determined by the bisection bandwidth and the fraction of traffic crossing it, γ, both of which are topology dependent. Here are the various cases:

> 注入和接收带宽盖有效带宽最大为 64 bw 单元（即使通信模式仅需要 56 bw 单元）。但是，该最大值可能会通过可实现的网络带宽来缩放，该网络带宽取决于一分配带宽和交通交通的交通比例，γ 均取决于拓扑。这是各种情况：

- _Bus_—The mapping of the 8 8 array elements to nodes makes no difference for the bus as all nodes are equally distant at one hop away. However, the 112 transfers are done sequentially, taking a total of 112 time units. The bisection bandwidth is 1, and γ is 100%. Thus, effective bandwidth is only 1 BW unit.

> - _bus_— 88 个数组元素对节点的映射对总线没有任何影响，因为所有节点在一个跳动中同样遥远。但是，112 个转移是顺序进行的，总共需要 112 个时间单位。一分解带宽为 1，γ 为 100％。因此，有效带宽仅为 1 BW 单元。

- _Ring_—Assume the first row of the array is mapped to nodes 0 to 7, the second row to nodes 8 to 15, and so on. It takes just one time unit for all nodes simul- taneously to send to their eastern neighbor (i.e., a transfer from node _i_ to node _i_ + 1). With this mapping, the northern neighbor for each node is exactly eight hops away so it takes eight time units, which also is done in parallel for all nodes. Total communication time is, therefore, 9 time units. The bisection bandwidth is 2 bidirectional links (assuming a bidirectional ring), which is less than the full bisection bandwidth of 32 bidirectional links. For eastward communication, because only 2 of the eastward 56 packets must cross the bisection in the worst case, the bisection links do not pose as bottlenecks. For northward communication, 8 of the 56 packets must cross the two bisec- tion links, yielding a γ of 10/112 8.93%. Thus, the network bandwidth is 2/.0893 22.4 BW units. This limits the effective bandwidth at 22.4 BW units as well, which is less than half the bandwidth required by the commu- nication pattern.

> - _ring_  - 安装阵列的第一行映射到节点 0 到 7，第二行将节点映射到节点 8 至 15，依此类推。所有节点都只需一个时间单元即可发送到其东部邻居（即从节点_i_到节点_i_ + 1 的传输）。有了这个映射，每个节点的北方邻居恰好是八个啤酒花，因此需要八个时间单元，这也是所有节点并行完成的。因此，总沟通时间为 9 个时间单元。一分为二的带宽是 2 个双向链路（假设双向环），该链路小于 32 个双向链路的完整一分配带宽。对于向东的通信，因为在最坏的情况下，只有 2 个向东的 56 包必须穿越一分点，因此一分为二的链接不会像瓶颈那样摆姿势。对于北向通信，在 56 个数据包中，有 8 个必须越过两个分配链接，γ 为 10/112 8.93％。因此，网络带宽为 2/.0893 22.4 bw 单元。这也将有效带宽限制为 22.4 bw 单元，这是通信模式所需的带宽的一半。

- _2D mesh_—There are eight rows and eight columns in our grid of 64 nodes, which is a perfect match to the NEWS communication. It takes a total of just 2 time units for all nodes to send simultaneously to their northern neighbors followed by simultaneous communication to their eastern neighbors. The bisection bandwidth is 8 bidirectional links, which is less than full bisection bandwidth. However, the perfect matching of this nearest neighbor communi- cation pattern on this topology allows the maximum effective bandwidth to be achieved regardless. For eastward communication, 8 of the 56 packets must cross the bisection in the worst case, which does not exceed the bisection band- width. None of the northward communications crosses the same network bisec- tion, yielding a γ of 8/112 7.14% and a network bandwidth of 8/0.0714 112 BW units. The effective bandwidth is, therefore, limited by the communication pattern at 56 BW units as opposed to the mesh network.

> - _2d 网格_-我们的 64 个节点的网格中有八行和八列，这与新闻传播的完美匹配。所有节点总共只需要 2 个时间单位才能同时发送给北部邻居，然后同时向东方邻居进行交流。一分为二的带宽是 8 个双向链路，它的双向链路不足。但是，这种拓扑结构的最接近的邻居通信模式的完美匹配可以使最大的有效带宽可实现。对于向东的通信，在最坏的情况下，在 56 个数据包中，有 8 个必须跨越一分为二，这不会超过一分为二的带宽。北部通信均未跨越相同的网络兼具，γ 为 8/112 7.14％，网络带宽为 8/0.0714 112 BW 单位。因此，有效带宽受到 56 BW 单元的通信模式而不是网络网络的限制。

- _2D torus_—Wrap-around links of the torus are not used for this communication pattern, so the torus has the same mapping and performance as the mesh.

> - _2d torus _-圆环的曲线链接不用于此通信模式，因此圆环具有与网格相同的映射和性能。

- _Hypercube_—Assume elements in each row are mapped to the same location within the eight 3-cubes comprising the hypercube such that consecutive row elements are mapped to nodes only one hop away. Northern neighbors can be similarly mapped to nodes only one hop away in an orthogonal dimension. Thus, the communication pattern takes just 2 time units. The hypercube provides full bisection bandwidth of 32 links, but at most only 8 of the 112 packets must cross the bisection. Thus, effective bandwidth is limited only by the communication pattern to be 56 BW units, not by the hypercube network.

> - _hyperCube_  - 每行的指示元素都映射到包含超立方体的八个 3 立方体中的同一位置，以使连续的行元素仅映射到节点仅一个跳节点。北方邻居可以类似地映射到一个正交维度的节点。因此，沟通模式仅需 2 个时间。HyperCube 提供了 32 个链接的完整一分配带宽，但最多只有 112 个数据包必须穿越二等。因此，有效的带宽仅受通信模式为 56 bw 单元的限制，而不受 HyperCube 网络的限制。

- _Fully connected_—Here, nodes are equally distant at one hop away, regardless of the mapping. Parallel transfer of packets in both the northern and eastern directions would take only 1 time unit if the injection and reception links could source and sink two packets at a time. As this is not the case, 2 time units are required. Effective bandwidth is limited by the communication pattern at 56 BW units, so the 1024 network bisection links largely go underutilized.

> - _ connected_-在此处，无论映射如何，节点在一个跳动中同样遥远。如果注入和接收链接可以一次来源和下沉两个数据包，则在北方和东方方向的数据包的平行传输只需 1 个时间单位。由于事实并非如此，因此需要 2 个时间单元。有效的带宽受到 56 BW 单元的通信模式的限制，因此 1024 网络分配链路在很大程度上不足。

- _Fat tree_—Assume the same mapping of elements to nodes as is done for the ring and the use of switches with eight bidirectional ports. This allows simul- taneous communication to eastern neighbors that takes at most three hops and, therefore, 3 time units through the three bidirectional stages interconnecting the eight nodes in each of the eight groups of nodes. The northern neighbor for each node resides in the adjacent group of eight nodes, which requires five hops, or 5 time units. Thus, the total time required on the fat tree is 8 time units. The fat tree provides full bisection bandwidth, so in the worst case of half the traffic needing to cross the bisection, an effective bandwidth of 56 BW units (as limited by the communication pattern and not by the fattree network) is achieved when packets are continually injected.

> - _FAT 树_-指示元素对节点的映射与为环和使用八个双向端口使用的开关所做的相同的映射。这允许与东方邻居进行模拟通信，这些邻居最多需要三个啤酒花，因此，通过三个双向阶段进行了 3 个时间单元，将八组节点中每个节点的八个节点互连。每个节点的北方邻居位于八个节点的相邻组中，该节点需要五个啤酒花或 5 个时间单位。因此，脂肪树上所需的总时间为 8 个时间单位。脂肪树提供了完整的一分配带宽，因此，在最坏的情况下，交通交易需要的一半是一半的交通设备，有效的带宽为 56 bw 单元（受通信模式的限制，而不是 FATTREE 网络），当时可以不断地实现数据包。注射。

The above example should not lead one to the wrong conclusion that meshes are just as good as tori, hypercubes, fat trees, and other networks with higher bisec- tion bandwidth. A number of simplifications that benefit low-bisection networks were assumed to ease the analysis. In practice, packets typically are larger than the link width and occupy links for many more than just one network cycle. Also, many communication patterns do not map so cleanly to the 2D mesh network topology; instead, usually they are more global and irregular in nature. These and other factors combine to increase the chances of packets blocking in low- bisection networks, increasing latency and reducing effective bandwidth.

> 上面的示例不应导致一个错误的结论，即网格与托里，超振烟，胖树和其他具有较高双分配带宽的网络一样好。假定有许多使低分辨率网络受益的简化可简化分析。实际上，数据包通常大于链接宽度，并且占用链接的链接不仅仅是一个网络周期。同样，许多通信模式并未如此清晰地映射到 2D 网络网络拓扑。相反，通常它们本质上是更全球性和不规则的。这些因素和其他因素结合在一起，以增加低分子网络中数据包阻断的机会，从而增加延迟并降低有效的带宽。

To put this discussion on topologies into further perspective, Figure F.16 lists various attributesoftopologiesusedincommercialhigh-performancecomputers.

> 为了将讨论从拓扑结构介绍到进一步的角度，图 F.16 列出了各种属性，formogyopologiessoplogysopermencilesmercialhigh-performancececomputers。
