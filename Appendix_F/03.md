> [!note]
> 和上一节一样，这里也有许多关于概念的阐述，感觉涉及到网络的知识的时候就是偏向逻辑，文字描述了...
> 这一章都可以再看一下

## Connecting More than Two Devices

To this point, we have considered the connection of only two devices communicating over a network viewed as a black box, but what makes interconnection networks interesting is the ability to connect hundreds or even many thousands of devices together. Consequently, what makes them interesting also makes them more challenging to build. In order to connect more than two devices, a suitable structure and more functionality must be supported by the network. This section continues with our black box approach by introducing, at a conceptual level, additional network structure and functions that must be supported when interconnecting more than two devices. More details on these individual subjects are given in [Sections F.4 through F.7](#network-topology). Where applicable, we relate the additional structure and functions to network media, flow control, and other basics presented in the previous section. In this section, we also classify networks into two broad categories based on their connection structure—_shared-media_ versus `switched-media` networks—and we compare them. Finally, expanded expressions for characterizing network performance are given, followed by an example.

> 至此，我们只考虑了通过网络通信的两个设备的连接被视为一个黑盒子，但互连网络的有趣之处在于能够将数百甚至数千个设备连接在一起。因此，使它们变得有趣的因素也使它们的构建更具挑战性。为了连接两个以上的设备，网络必须支持合适的结构和更多的功能。本节继续介绍我们的黑盒方法，在概念层面上介绍互连两个以上设备时必须支持的其他网络结构和功能。[Sections F.4 through F.7](#network-topology) 中给出了有关这些单独主题的更多详细信息。在适用的情况下，我们将附加结构和功能与网络媒体、流量控制和上一节中介绍的其他基础知识联系起来。在本节中，我们还根据网络的连接结构将网络分为两大类——*共享媒体*与 "交换媒体" 网络——并对它们进行比较。最后，给出了表征网络性能的扩展表达式，并给出了一个例子。

Figure F.7 Basic characteristics of interconnection networks in commercial high-performance computer systems.

### Additional Network Structure and Functions: Topology, Routing, Arbitration, and Switching

Networks interconnecting more than two devices require mechanisms to physically connect the packet source to its destination in order to transport the packet and deliver it to the correct destination. These mechanisms can be implemented in different ways and significantly vary across interconnection network domains. However, the types of network structure and functions performed by those mechanisms are very much the same, regardless of the domain.

> 互连的网络需要两个以上的设备，需要机制将数据包源连接到其目的地，以运输数据包并将其运送到正确的目的地。这些机制可以以不同的方式实现，并且在互连网络域之间有很大变化。但是，无论域如何，这些机械主义执行的网络结构和功能的类型都是非常相同的。

When multiple devices are interconnected by a network, the connections between them oftentimes cannot be permanently established with dedicated links.

> 当多个设备通过网络互连时，它们之间的连接通常无法通过专用链接永久建立。

This could either be too restrictive as all the packets from a given source would go to the same one destination (and not to others) or prohibitively expensive as a dedicated link would be needed from every source to every destination (we will evaluate this further in the next section). Therefore, networks usually share paths among different pairs of devices, but how those paths are shared is determined by the network connection structure, commonly referred to as the network `topology`. Topology addresses the important issue of "_What paths are possible for packets?_" so packets reach their intended destinations.

> 这可能过于严格，因为来自给定源的所有数据包都将到达同一个目的地(而不是其他目的地)，或者过于昂贵，因为从每个源到每个目的地都需要专用链路(我们将在 下一节)。因此，网络通常在不同的设备对之间共享路径，但这些路径如何共享是由网络连接结构决定的，通常称为网络 "拓扑" 。拓扑解决了 "_数据包可能有哪些路径？_" 这一重要问题，因此数据包可以到达它们的预定目的地。

Every network that interconnects more than two devices also requires some mechanism to deliver each packet to the correct destination. The associated function is referred to as `routing`, which can be defined as the set of operations that need to be performed to compute a valid path from the packet source to its destinations. Routing addresses the important issue of "_Which of the possible paths are allowable (valid) for packets?_" so packets reach their intended destinations. Depending on the network, this function may be executed at the packet source to compute the entire path, at some intermediate devices to compute fragments of the path on the fly, or even at every possible destination device to verify whether that device is the intended destination for the packet. Usually, the packet header shown in [Figure F.4](#_bookmark601) is extended to include the necessary routing information.

> 每个互连两个以上设备的网络也需要某种机制来将每个数据包传送到正确的目的地。关联的功能称为 "路由" ，它可以定义为计算从数据包源到其目的地的有效路径所需执行的一组操作。路由解决了 "_哪些可能的路径对数据包是允许的(有效的)？_" 这一重要问题，因此数据包可以到达它们的预期目的地。根据网络的不同，此功能可能在数据包源处执行以计算整个路径，在某些中间设备上执行以动态计算路径片段，甚至在每个可能的目标设备上执行以验证该设备是否是预期目标 对于数据包。通常，[图 F.4](#_bookmark601) 中所示的包头被扩展以包括必要的路由信息 ​​。

In general, as networks usually contain shared paths or parts thereof among different pairs of devices, packets may request some shared resources. When several packets request the same resources at the same time, an `arbitration` function is required to resolve the conflict. Arbitration, along with flow control, addresses the important issue of "_When are paths available for packets?_" Every time arbitration is performed, there is a winner and possibly several losers. The losers are not granted access to the requested resources and are typically buffered. As indicated in the previous section, flow control may be implemented to prevent buffer overflow. The winner proceeds toward its destination once the granted resources are switched in, providing a path for the packet to advance. This function is referred to as `switching`. Switching addresses the important issue of "_How are paths allocated to packets?_" To achieve better utilization of existing communication resources, most networks do not establish an entire end-to-end path at once. Instead, as explained in [Section F.5](#network-routing-arbitration-and-switching), paths are usually established one fragment at a time.

> 通常，由于网络通常包含不同设备对之间的共享路径或其中的一部分，因此数据包可能会请求一些共享资源。当多个数据包同时请求相同的资源时，需要一个 "仲裁" 功能来解决冲突。仲裁连同流量控制解决了 "_什么时候路径可用于数据包？_" 这一重要问题。每次执行仲裁时，都会有一个赢家，也可能有几个输家。失败者未被授予访问所请求资源的权限，并且通常被缓冲。如前一节所述，可以实施流量控制以防止缓冲区溢出。一旦授予的资源被切换，获胜者就会前往目的地，为数据包前进提供路径。此功能称为 "切换" 。交换解决了 "_路径如何分配给数据包？_" 这一重要问题，为了更好地利用现有通信资源，大多数网络不会立即建立完整的端到端路径。相反，如 [第 F.5 节](#network-routing-arbitration-and-switching)中所述，路径通常一次建立一个片段。

These three network functions—routing, arbitration, and switching—must be implemented in every network connecting more than two devices, no matter what form the network topology takes. This is in addition to the basic functions mentioned in the previous section. However, the complexity of these functions and the order in which they are performed depends on the category of network topology, as discussed below. In general, routing, arbitration, and switching are required to establish a valid path from source to destination from among the possible paths provided by the network topology. Once the path has been established, the packet transport functions previously described are used to reliably transmit packets and receive them at the corresponding destination. Flow control, if implemented, prevents buffer overflow by throttling the sender. It can be implemented at the end-toend level, the link level within the network, or both.

> 这三种网络功能——路由、仲裁和交换——必须在连接两个以上设备的每个网络中实现，无论网络拓扑采用什么形式。这是对上一节中提到的基本功能的补充。然而，这些功能的复杂性和它们执行的顺序取决于网络拓扑的类别，如下所述。通常，需要路由、仲裁和交换来从网络拓扑提供的可能路径中建立从源到目的地的有效路径。一旦建立了路径，前面描述的数据包传输功能将用于可靠地传输数据包并在相应的目的地接收它们。流量控制，如果实现的话，可以通过限制发送者来防止缓冲区溢出。它可以在端到端级别、网络内的链路级别或两者实现。

### Shared-Media Networks

The simplest way to connect multiple devices is to have them share the network media, as shown for the bus in [Figure F.8](#_bookmark605) (a). This has been the traditional way of interconnecting devices. The shared media can operate in `half-duplex` mode, where data can be carried in either direction over the media but simultaneous transmission and reception of data by the same device is not allowed, or in `full-duplex,` where the data can be carried in both directions and simultaneously transmitted and received by the same device. Until very recently, I/O devices in most systems typically shared a single I/O bus, and early system-on-chip (SoC) designs made use of a shared bus to interconnect on-chip components. The most popular LAN, Ethernet, was originally implemented as a half-duplex bus shared by up to a hundred computers, although now switched-media versions also exist.

> 连接多个设备的最简单方法是让它们共享网络媒体，如[图 F.8](#_bookmark605) (a) 中的总线所示。这是互连设备的传统方式。共享媒体可以在 "半双工" 模式下运行，其中数据可以在媒体上的任一方向上传输，但不允许同一设备同时传输和接收数据，或者在 "全双工" 模式下，数据 可以双向携带，并由同一设备同时发送和接收。直到最近，大多数系统中的 I/O 设备通常共享单个 I/O 总线，而早期的片上系统 (SoC) 设计使用共享总线互连片上组件。最流行的 LAN，以太网，最初是作为由多达一百台计算机共享的半双工总线实现的，尽管现在也存在交换媒体版本。

Given that network media are shared, there must be a mechanism to coordinate and arbitrate the use of the shared media so that only one packet is sent at a time. If the physical distance between network devices is small, it may be possible to have a central arbiter to grant permission to send packets. In this case, the network nodes may use dedicated control lines to interface with the arbiter. Centralized arbitration is impractical, however, for networks with a large number of nodes spread over large distances, so distributed forms of arbitration are also used. This is the case for the original Ethernet shared-media LAN.

> 鉴于网络媒体是共享的，必须有一种机制来协调和仲裁共享媒体的使用，以便一次只发送一个数据包。如果网络设备之间的物理距离很小，可能有一个中央仲裁器来授予发送数据包的权限。在这种情况下，网络节点可以使用专用控制线与仲裁器连接。集中式仲裁是不切实际的，然而，对于大量节点分布在很远距离的网络，因此也使用分布式形式的仲裁。最初的以太网共享媒体局域网就是这种情况。

A first step toward distributed arbitration of shared media is "looking before you leap." A node first checks the network to avoid trying to send a packet while another packet is already in the network. Listening before transmission to avoid collisions is called `carrier sensing`. If the interconnection is idle, the node tries to send. Looking first is not a guarantee of success, of course, as some other node may also decide to send at the same instant. When two nodes send at the same time, a `collision` occurs. Let’s assume that the network interface can detect any resulting collisions by listening to hear if the data become garbled by other data appearing on the line. Listening to detect collisions is called `collision detection`. This is the second step of distributed arbitration.

> 共享媒体的分布式仲裁的第一步是 "三思而后行" 。节点首先检查网络，以避免在另一个数据包已在网络中时尝试发送数据包。在传输之前收听以避免冲突称为 "载波侦听" 。如果互连空闲，则该节点尝试发送。首先查看并不能保证成功，当然，因为其他一些节点也可能决定在同一时刻发送。当两个节点同时发送时，就会发生 "冲突" 。让我们假设网络接口可以通过监听数据是否被线路上出现的其他数据混淆来检测任何由此产生的冲突。侦听碰撞检测称为 "碰撞检测" 。这是分布式仲裁的第二步。

Figure F.8 (a) A shared-media network versus (b) a switched-media network. Ethernet was originally a shared media network, but switched Ethernet is now available. All nodes on the shared-media networks must dynamically share the raw bandwidth of one link, but switched-media networks can support multiple links, providing higher raw aggregate bandwidth.

> 图 F.8(a)共享媒体网络与(b)交换媒体网络。EtherNet 最初是一个共享的媒体网络，但是现在可以使用切换的以太网。共享媒体网络上的所有节点都必须动态共享一个链接的原始带宽，但是切换的媒体网络可以支持多个链接，从而提供更高的原始聚合带宽。

The problem is not solved yet. If, after detecting a collision, every node on the network waited exactly the same amount of time, listened to be sure there was no traffic, and then tried to send again, we could still have synchronized nodes that would repeatedly bump heads. To avoid repeated head-on collisions, each node whose packet gets garbled waits (or `backs off`) a random amount of time before resending. Randomization breaks the synchronization. Subsequent collisions result in exponentially increasing time between attempts to retransmit, so as not to tax the network.

> 问题还没有解决。如果在检测到冲突后，网络上的每个节点都等待完全相同的时间，监听以确保没有流量，然后再次尝试发送，我们仍然可以拥有会反复碰撞头部的同步节点。为了避免重复的正面冲突，每个数据包被混淆的节点在重新发送之前等待(或 "后退" )一段随机时间。随机化打破了同步。随后的冲突导致重传尝试之间的时间呈指数增长，以免对网络造成负担。

Although this approach controls congestion on the shared media, it is not guaranteed to be fair—some subsequent node may transmit while those that collided are waiting. If the network does not have high demand from many nodes, this simple approach works well. Under high utilization, however, performance degrades since the media are shared and fairness is not ensured. Another distributed approach to arbitration of shared media that can support fairness is to pass a token between nodes. The function of the token is to grant the acquiring node the right to use the network. If the token circulates in a cyclic fashion between the nodes, a certain amount of fairness is ensured in the arbitration process.

> 尽管这种方法可以控制共享媒体上的拥塞，但不能保证公平——某些后续节点可能会在发生冲突的节点等待时进行传输。如果网络没有来自许多节点的高需求，这种简单的方法很有效。然而，在高利用率下，性能会下降，因为媒体是共享的，公平性得不到保证。另一种可以支持公平性的共享媒体仲裁分布式方法是在节点之间传递令牌。代币的作用是授予获取节点使用网络的权利。如果令牌在节点之间以循环方式流通，则在仲裁过程中确保了一定程度的公平性。

Once arbitration has been performed and a device has been granted access to the shared media, the function of switching is straightforward. The granted device simply needs to connect itself to the shared media, thus establishing a path to every possible destination. Also, routing is very simple to implement. Given that the media are shared and attached to all the devices, every device will see every packet. Therefore, each device just needs to check whether or not a given packet is intended for that device. A beneficial side effect of this strategy is that a device can send a packet to all the devices attached to the shared media through a single transmission. This style of communication is called `broadcasting`, in contrast to `unicasting,` in which each packet is intended for only one device. The shared media make it easy to broadcast a packet to every device or, alternatively, to a subset of devices, called `multicasting.`

> 一旦执行了仲裁并且设备被授予访问共享媒体的权限，切换功能就很简单了。被授权的设备只需将自己连接到共享媒体，从而建立通往每个可能目的地的路径。此外，路由实现起来非常简单。鉴于媒体共享并附加到所有设备，每个设备都会看到每个数据包。因此，每个设备只需要检查给定的数据包是否针对该设备。这种策略的一个有益的副作用是设备可以通过单次传输将数据包发送到连接到共享媒体的所有设备。这种通信方式称为 "广播" ，与 "单播" 形成对比，其中每个数据包仅用于一个设备。共享媒体使得向每个设备或向设备子集广播数据包变得容易，这称为 "多播" 。

### Switched-Media Networks

The alternative to sharing the entire network media at once across all attached nodes is to switch between disjoint portions of it shared by the nodes. Those portions consist of passive `point-to-point links` between active `switch` components that dynamically establish communication between sets of source-destination pairs. These passive and active components make up what is referred to as the network `switch fabric` or `network fabric`, to which end nodes are connected. This approach is shown conceptually in [Figure F.8(b)](#_bookmark605). The switch fabric is described in greater detail in [Sections F.4 through F.7](#network-topology), where various black box layers for switchedmedia networks are further revealed. Nevertheless, the high-level view shown in [Figure F.8(b)](#_bookmark605) illustrates the potential bandwidth improvement of switchedmedia networks over shared-media networks: aggregate bandwidth can be many times higher than that of shared-media networks, allowing the possibility of greater effective bandwidth to be achieved. At best, only one node at a time can transmit packets over the shared media, whereas it is possible for all attached nodes to do so over the switched-media network.

> 在所有连接的节点上一次共享整个网络媒体的替代方法是在节点共享的不相交部分之间切换。这些部分由主动 "开关" 组件之间的被动 "点对点链接" 组成，这些组件动态地在源-目的地对组之间建立通信。这些无源和有源组件构成了所谓的网络 "交换结构" 或 "网络结构" ，终端节点连接到这些组件。[图 F.8(b)](#_bookmark605) 从概念上展示了这种方法。[Sections F.4 through F.7](#network-topology) 中更详细地描述了交换结构，其中进一步揭示了交换媒体网络的各种黑盒层。尽管如此，[图 F.8(b)](#_bookmark605) 中显示的高级视图说明了交换媒体网络相对于共享媒体网络的潜在带宽改进：聚合带宽可以比共享媒体网络高许多倍 ，允许实现更大有效带宽的可能性。充其量，一次只有一个节点可以通过共享媒体传输数据包，而所有连接的节点都可以通过交换媒体网络进行传输。

Like their shared-media counterparts, switched-media networks must implement the three additional functions previously mentioned: routing, arbitration, and switching. Every time a packet enters the network, it is routed in order to select a path toward its destination provided by the topology. The path requested by the packet must be granted by some centralized or distributed arbiter, which resolves conflicts among concurrent requests for resources along the same path. Once the requested resources are granted, the network "switches in" the required connections to establish the path and allows the packet to be forwarded toward its destination. If the requested resources are not granted, the packet is usually buffered, as mentioned previously. Routing, arbitration, and switching functions are usually performed within switched networks in this order, whereas in shared-media networks routing typically is the last function performed.

> 与它们的共享媒体对应物一样，交换媒体网络必须实现前面提到的三个附加功能：**路由、仲裁和交换**。每次数据包进入网络时，都会对其进行路由，以便选择通向拓扑提供的目的地的路径。数据包请求的路径必须由某个集中式或分布式仲裁器授予，它解决了沿同一路径对资源的并发请求之间的冲突。一旦请求的资源被授予，网络就会 "切换" 所需的连接以建立路径并允许将数据包转发到其目的地。如果请求的资源未被授予，则数据包通常会被缓冲，如前所述。路由、仲裁和交换功能通常在交换网络中按此顺序执行，而在共享媒体网络中，路由通常是最后执行的功能。

### Comparison of Sharedand Switched-Media Networks

In general, the advantage of shared-media networks is their low cost, but, consequently, their aggregate network bandwidth does not scale at all with the number of interconnected devices. Also, a global arbitration scheme is required to resolve conflicting demands, possibly introducing another type of bottleneck and again limiting scalability. Moreover, every device attached to the shared media increases the parasitic capacitance of the electrical conductors, thus increasing the time of flight propagation delay accordingly and, possibly, clock cycle time. In addition, it is more difficult to pipeline packet transmission over the network as the shared media are continuously granted to different requesting devices.

> 一般来说，共享媒体网络的优势是成本低，但因此，它们的聚合网络带宽根本不会随着互连设备的数量而扩展。此外，需要一种全局仲裁方案来解决冲突的需求，这可能会引入另一种类型的瓶颈并再次限制可扩展性。此外，连接到共享介质的每个设备都会增加电导体的寄生电容，从而相应地增加飞行时间传播延迟，并可能增加时钟周期时间。此外，由于共享媒体不断地被授予不同的请求设备，因此通过网络传输数据包变得更加困难。

The main advantage of switched-media networks is that the amount of network resources implemented scales with the number of connected devices, increasing the aggregate network bandwidth. These networks allow multiple pairs of nodes to communicate simultaneously, allowing much higher effective network bandwidth than that provided by shared-media networks. Also, switched-media networks allow the system to scale to very large numbers of nodes, which is not feasible when using shared media. Consequently, this scaling advantage can, at the same time, be a disadvantage if network resources grow superlinearly. Networks of superlinear cost that provide an effective network bandwidth that grows only sublinearly with the number of interconnected devices are inefficient designs for many applications and interconnection network domains.

> 交换媒体网络的主要优点是实现的网络资源量与连接设备的数量成比例，从而增加了总网络带宽。这些网络允许多对节点同时通信，允许比共享媒体网络提供的有效网络带宽高得多。此外，交换媒体网络允许系统扩展到大量节点，这在使用共享媒体时是不可行的。因此，如果网络资源超线性增长，这种扩展优势同时可能成为劣势。超线性成本网络提供的有效网络带宽仅随互连设备的数量呈亚线性增长，对于许多应用程序和互连网络域而言是低效设计。

### Characterizing Performance: Latency and Effective Bandwidth

The routing, switching, and arbitration functionality described above introduces some additional components of packet transport latency that must be taken into account in the expression for total packet latency. Assuming there is no contention for network resources—as would be the case in an unloaded network—total packet latency is given by the following:

> 上述路由、交换和仲裁功能引入了一些额外的数据包传输延迟组件，在总数据包延迟的表达式中必须考虑这些组件。假设不存在网络资源争用——如卸载网络中的情况——总数据包延迟由以下公式给出：

Here `T` R, `T` A, and `T` S are the total routing time, arbitration time, and switching time experienced by the packet, respectively, and are either measured quantities or calculated quantities derived from more detailed analyses. These components are added to the total propagation delay through the network links, `T` TotalProp, to give the overall time of flight of the packet.

> 这里的 `T` R、`T` A 和 `T` S 分别是数据包经历的总路由时间、仲裁时间和切换时间，并且是测量量或从更详细的分析中得出的计算量。这些分量被添加到通过网络链路的总传播延迟 TTotalProp 中，以给出数据包的总飞行时间。

The expression above gives only a lower bound for the total packet latency as it does not account for additional delays due to contention for resources that may occur. When the network is heavily loaded, several packets may request the same network resources concurrently, thus causing contention that degrades performance. Packets that lose arbitration have to be buffered, which increases packet latency by some `contention delay` amount of waiting time. This additional delay is not included in the above expression. When the network or part of it approaches saturation, contention delay may be several orders of magnitude greater than the total packet latency suffered by a packet under zero load or even under slightly loaded network conditions. Unfortunately, it is not easy to compute analytically the total packet latency when the network is more than moderately loaded. Measurement of these quantities using cycle-accurate simulation of a detailed network model is a better and more precise way of estimating packet latency under such circumstances. Nevertheless, the expression given above is useful in calculating `best-case lower bounds` for packet latency.

> 上面的表达式只给出了总数据包延迟的下限，因为它没有考虑由于可能发生的资源争用而导致的额外延迟。当网络负载很重时，多个数据包可能同时请求相同的网络资源，从而导致性能下降的争用。失去仲裁的数据包必须被缓冲，这增加了一些 "争用延迟" 等待时间的数据包延迟。这个额外的延迟不包括在上面的表达式中。当网络或其一部分接近饱和时，**竞争延迟**可能比数据包在零负载甚至轻负载网络条件下所遭受的总数据包延迟大几个数量级。不幸的是，当网络负载超过适度负载时，分析计算总数据包延迟并不容易。在这种情况下，使用详细网络模型的周期精确模拟来测量这些量是一种更好、更精确的估计数据包延迟的方法。尽管如此，上面给出的表达式对于计算数据包延迟的 "最佳情况下限" 很有用。

For similar reasons, effective bandwidth is not easy to compute exactly, but we can estimate `best-case upper bounds` for it by appropriately extending the model presented at the end of the previous section. What we need to do is to find the narrowest section of the end-to-end network pipe by finding the network injection bandwidth (BWNetworkInjection), the network reception bandwidth (BWNetworkRecep- tion), and the network bandwidth (BWNetwork) across the entire network interconnecting the devices.

> 出于类似的原因，有效带宽不容易精确计算，但我们可以通过适当扩展上一节末尾提供的模型来为其估算 "最佳情况上限" 。我们需要做的是通过找到整个网络注入带宽(BWNetworkInjection)、网络接收带宽(BWNetworkReception)和网络带宽(BWNetwork)来找到端到端网络管道的最窄部分。网络互连设备。

The BWNetworkInjection can be calculated simply by multiplying the expression for link injection bandwidth, BWLinkInjection, by the total number of network injection links. The BWNetworkReception is calculated similarly using BWLinkReception, but it must also be scaled by a factor that reflects application traffic and other characteristics. For more than two interconnected devices, it is no longer valid to assume a one-to-one relationship among sources and destinations when analyzing the effect of flow control on link reception bandwidth. It could happen, for example, that several packets from different injection links arrive concurrently at the same reception link for applications that have many-to-one traffic characteristics, which causes contention at the reception links. This effect can be taken into account by an `average reception factor` parameter, σ, which is either a measured quantity or a calculated quantity derived from detailed analysis. It is defined as the average fraction or percentage of packets arriving at reception links that can be accepted. Only those packets can be immediately delivered, thus reducing network reception bandwidth by that factor. This reduction occurs as a result of application behavior regardless of internal network characteristics. Finally, BWNetwork takes into account the internal characteristics of the network, including contention. We will progressively derive expressions in the following sections that will enable us to calculate this as more details are revealed about the internals of our black box interconnection network.

> BWNetworkInjection 可以简单地通过将链路注入带宽的表达式 BWLinkInjection 乘以网络注入链路的总数来计算。BWNetworkReception 的计算方法与 BWLinkReception 类似，但它还必须按反映应用程序流量和其他特征的因子进行缩放。对于两个以上的互连设备，在分析流量控制对链路接收带宽的影响时，假定源和目标之间的一对一关系不再有效。例如，对于具有多对一流量特性的应用程序，来自不同注入链路的多个数据包可能会同时到达同一接收链路，这会导致接收链路发生争用。这种影响可以通过 "平均接收因子" 参数 σ 来考虑，它可以是测量量，也可以是从详细分析中得出的计算量。它被定义为可以接受的到达接收链路的数据包的平均分数或百分比。只有那些数据包可以立即传送，从而减少了网络接收带宽的那个因素。这种减少是应用程序行为的结果，与内部网络特征无关。最后，BWNetwork 考虑了网络的内部特征，包括竞争。随着有关黑盒互连网络内部结构的更多细节被揭示，我们将在以下部分逐步推导出表达式，使我们能够计算这一点。

Overall, the effective bandwidth delivered by the network end-to-end to an application is determined by the minimum across the three sections, as described by the following:

> 总体而言，网络端到端交付给应用程序的有效带宽取决于以下三个部分的最小值，如下所述：

Let’s use the above expressions to compare the latency and effective bandwidth of shared-media networks against switched-media networks for the four interconnection network domains: OCNs, SANs, LANs, and WANs.

> 让我们使用上述表达式将共享媒体网络的延迟和有效带宽与四个互连网络域的交换媒体网络的延迟和有效的带宽进行比较：OCN，SANS，LANS 和 WANS。

Example Plot the total packet latency and effective bandwidth as the number of interconnected nodes, `N`, scales from 4 to 1024 for shared-media and switched-media OCNs, SANs, LANs, and WANs. Assume that all network links, including the injection and reception links at the nodes, each have a data bandwidth of 8 Gbps, and unicast packets of 100 bytes are transmitted. Shared-media networks share one link, and switched-media networks have at least as many network links as there are nodes. For both, ignore latency and bandwidth effects due to contention within the network. End nodes have per-packet sending and receiving overheads of `x` + 0.05 ns/byte and 4/3(_x_) + 0.05 ns/byte, respectively, where `x` is 0 μs for the OCN, 0.3 μs for the SAN, 3 μs for the LAN, and 30 μs for the WAN, and interconnection distances are 0.5 cm, 5 m, 5000 m, and 5000 km, respectively. Also assume that the total routing, arbitration, and switching times are constants or functions of the number of interconnected nodes: `T` R 2.5 ns, `T` A 2.5(_N_) ns, and `T` S 2.5 ns for shared-media networks and `T` R `T` A `T` S 2.5(log2 `N`) ns for switched-media networks. Finally, taking into account application traffic characteristics for the network structure, the average reception factor, σ, is assumed to be

> 示例 为共享媒体和交换媒体 OCN、SAN、LAN 和 WAN 绘制总数据包延迟和有效带宽作为互连节点数 "N" 的比例从 4 到 1024。假设所有网络链路，包括节点的注入链路和接收链路，每条数据带宽为 8Gbps，传输 100 字节的单播数据包。共享媒体网络共享一条链路，而交换媒体网络至少有与节点一样多的网络链路。对于两者，请忽略由于网络内部争用而导致的延迟和带宽影响。端节点的每个数据包发送和接收开销分别为 `x` + 0.05 ns/字节和 4/3(_x_) + 0.05 ns/字节，其中 `x` 对于 OCN 为 0 μs，对于 SAN 为 0.3 μs , LAN 为 3μs，WAN 为 30μs，互连距离分别为 0.5cm、5m、5000m、5000km。还假设总路由、仲裁和切换时间是互连节点数的常数或函数：`T` R 2.5 ns、`T` A 2.5(_N_) ns 和 `T` S 2.5 ns 对于共享- 媒体网络和 `T` R `T` A `T` S 2.5(log2 `N`) ns 用于交换媒体网络。最后，考虑到网络结构的应用流量特性，假设平均接收因子 σ 为

_Answer_ All components of total packet latency are the same as in the example given in the previous section except for time of flight, which now has additional routing, arbitration, and switching delays. For shared-media networks, the additional delays total 5 + 2.5(_N_) ns; for switched-media networks, they total 7.5(log2 `N`) ns. Latency is plotted only for OCNs and SANs in [Figure F.9](#_bookmark606) as these networks give the more interesting results. For OCNs, `T` R, `T` A, and `T` S combine to dominate time of flight and are much greater than each of the other latency components for a moderate to large number of nodes. This is particularly so for the shared-media network. The latency increases much more dramatically with the number of nodes for shared media as compared to switched media given the difference in arbitration delay between the two. For SANs, `T` R, `T` A, and `T` S dominate time of flight for most network sizes but are greater than each of the other latency components in sharedmedia networks only for large-sized networks; they are less than the other latency components for switched-media networks but are not negligible. For LANs and WANs, time of flight is dominated by propagation delay, which dominates other latency components as calculated in the previous section; thus, `T` R, `T` A, and `T` S are negligible for both shared and switched media.

> _Answer_ 总数据包延迟的所有组成部分都与上一节中给出的示例相同，除了飞行时间，它现在有额外的路由、仲裁和交换延迟。对于共享媒体网络，额外延迟总计 5 + 2.5(_N_) ns；对于交换媒体网络，它们总计 7.5(log2 `N`) ns。[图 F.9](#_bookmark606) 中仅绘制了 OCN 和 SAN 的延迟，因为这些网络给出了更有趣的结果。对于 OCN，`T` R、`T` A 和 `T` S 组合在一起控制飞行时间，并且对于中等到大量节点而言，它们比其他每个延迟组件都大得多。对于共享媒体网络来说尤其如此。考虑到两者之间的仲裁延迟差异，与交换媒体相比，共享媒体的延迟随着节点数量的增加而显着增加。对于 SAN，'T'R、'T'A 和 它们小于交换媒体网络的其他延迟组件，但不可忽略。对于 LAN 和 WAN，飞行时间受传播延迟支配，传播延迟支配上一节中计算的其他延迟成分；因此，`T` R、`T` A 和 `T` S 对于共享媒体和交换媒体都可以忽略不计。

Figure F.9 Latency versus number of interconnected nodes plotted in semi-log form for OCNs and SANs. Routing, arbitration, and switching have more ofanimpactonlatency for networks in these two domains, particularly for networks with a large number of nodes, given the low sending and receiving overheads and low propagation delay.

> 图 F.9 以 OCN 和 SAN 的半对数形式绘制的延迟与互连节点数的关系。路由、仲裁和交换对这两个域中的网络具有更大的延迟影响，特别是对于具有大量节点的网络，考虑到低发送和接收开销以及低传播延迟。

[Figure F.10](#_bookmark607) plots effective bandwidth versus number of interconnected nodes for the four network domains. The effective bandwidth for all shared-media networks is constant through network scaling as only one unicast packet can be received at a time over all the network reception links, and that is further limited by the receiving overhead of each network for all but the OCN. The effective bandwidth for all switched-media networks increases with the number of interconnected nodes, but it is scaled down by the average reception factor. The receiving overhead further limits effective bandwidth for all but the OCN.

> [图 F.10](#_bookmark607) 绘制了四个网络域的有效带宽与互连节点数的关系图。所有共享媒体网络的有效带宽通过网络扩展是恒定的，因为在所有网络接收链路上一次只能接收一个单播数据包，并且除了 OCN 之外，这进一步受到每个网络的接收开销的限制。所有交换媒体网络的有效带宽都随着互连节点的数量而增加，但它会按平均接收因子按比例缩小。接收开销进一步限制了除 OCN 之外的所有带宽的有效带宽。

Figure F.10 Effective bandwidth versus number of interconnected nodes plotted in semi-log form for the four network domains. The disparity in effective bandwidth between sharedand switched-media networks for all interconnect domains widens significantly as the number of nodes in the network increases. Only the switched on-chip network is able to achieve an effective bandwidth equal to the aggregate bandwidth for the parameters given in this example.

> 图 F.10 以半对数形式绘制的四个网络域的有效带宽与互连节点数的关系。随着网络中节点数量的增加，所有互连域的共享媒体网络和交换媒体网络之间的有效带宽差异显着扩大。对于本例中给定的参数，只有交换式片上网络能够实现等于总带宽的有效带宽。

Given the obvious advantages, why weren’t switched networks always used? Earlier computers were much slower and could share the network media with little impact on performance. In addition, the switches for earlier LANs and WANs took up several large boards and were about as large as an entire computer. As a consequence of Moore’s law, the size of switches has reduced considerably, and systems have a much greater need for high-performance communication. Switched networks allow communication to harvest the same rapid advancements from silicon as processors and main memory. Whereas switches from telecommunication companies were once the size of mainframe computers, today we see single-chip switches and even entire switched networks within a chip. Thus, technology and application trends favor switched networks today. Just as single-chip processors led to processors replacing logic circuits in a surprising number of places, single-chip switches and switched on-chip networks are increasingly replacing shared-media networks (i.e., buses) in several application domains. As an example, PCI-Express (PCIe)—a switched network—was introduced in 2005 to replace the traditional PCI-X bus on personal computer motherboards.

> 鉴于明显的优势，为什么不总是使用交换网络？ 早期的计算机速度要慢得多，并且可以共享网络媒体而对性能影响很小。此外，早期 LAN 和 WAN 的交换机占用几块大板，大约有整台计算机那么大。由于摩尔定律，开关的尺寸已大大减小，系统对高性能通信的需求也大大增加。交换网络允许通信从硅中收获与处理器和主存储器相同的快速进步。电信公司的交换机曾经是大型计算机的大小，而今天我们看到的是单芯片交换机，甚至是芯片内的整个交换网络。因此，技术和应用趋势有利于当今的交换网络。正如单芯片处理器导致处理器在数量惊人的地方取代逻辑电路一样，单芯片交换机和片上交换网络也越来越多地在几个应用领域取代共享媒体网络(即总线)。例如，PCI-Express (PCIe)——一种交换网络——于 2005 年推出，用于取代个人计算机主板上的传统 PCI-X 总线。

The previous example also highlights the importance of optimizing the routing, arbitration, and switching functions in OCNs and SANs. For these network domains in particular, the interconnect distances and overheads typically are small enough to make latency and effective bandwidth much more sensitive to how well these functions are implemented, particularly for larger-sized networks. This leads mostly to implementations based mainly on the faster hardware solutions for these domains. In LANs and WANs, implementations based on the slower but more flexible software solutions suffice given that performance is largely determined by other factors. The design of the topology for switched-media networks also plays a major role in determining how close to the lower bound on latency and the upper bound on effective bandwidth the network can achieve for OCN and SAN domains.

> 前面的示例还强调了优化 OCN 和 SAN 中的路由、仲裁和交换功能的重要性。特别是对于这些网络域，互连距离和开销通常小到足以使延迟和有效带宽对这些功能的实现程度更加敏感，尤其是对于大型网络。这主要导致主要基于这些领域更快的硬件解决方案的实现。在 LAN 和 WAN 中，基于较慢但更灵活的软件解决方案的实施就足够了，因为性能在很大程度上取决于其他因素。交换媒体网络的拓扑设计在确定网络可以为 OCN 和 SAN 域实现的延迟下限和有效带宽上限的接近程度方面也起着重要作用。

The next three sections touch on these important issues in switched networks, with the next section focused on topology.

> 接下来的三个部分涉及交换网络中的这些重要问题，下一节重点介绍了**拓扑**。
