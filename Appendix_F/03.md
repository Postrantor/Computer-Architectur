## Connecting More than Two Devices

> ##连接两个以上的设备

To this point, we have considered the connection of only two devices communi- cating over a network viewed as a black box, but what makes interconnection net- works interesting is the ability to connect hundreds or even many thousands of devices together. Consequently, what makes them interesting also makes them more challenging to build. In order to connect more than two devices, a suitable structure and more functionality must be supported by the network. This section continues with our black box approach by introducing, at a conceptual level, addi- tional network structure and functions that must be supported when interconnect- ing more than two devices. More details on these individual subjects are given in [Sections F.4 through F.7](#network-topology). Where applicable, we relate the additional structure and functions to network media, flow control, and other basics presented in the previ- ous section. In this section, we also classify networks into two broad categories

> 为此，我们考虑了仅通过被视为黑匣子的网络进行通信的两个设备的连接，但是使互连网络工作有趣的是能够将数百甚至数千个设备连接在一起的能力。因此，使它们变得有趣的原因也使他们更具挑战性。为了连接两个以上的设备，网络必须支持合适的结构和更多功能。本节继续我们的黑匣子方法，通过在互连超过两个设备互连时将必须支持的概念级别的添加网络结构和功能引入。有关这些单独主题的更多详细信息，请在[F.4 至 F.7 节]中给出(＃网络 - 访问)。如果适用，我们将附加的结构和功能与网络媒体，流控制和前面部分中介绍的其他基础知识相关联。在本节中，我们还将网络分为两个广泛类别

Figure F.7 Basic characteristics of interconnection networks in commercial high-performance computer systems.

> 图 F.7 商业高性能计算机系统中互连网络的基本特征。

based on their connection structure—_shared-media_ versus _switched-media_ net- works—and we compare them. Finally, expanded expressions for characterizing network performance are given, followed by an example.

> 根据它们的连接结构-_shared-Media_ vess _switched-Media_ Net-works-并进行比较。最后，给出了表征网络性能的扩展表达式，其次是一个示例。

### Additional Network Structure and Functions: Topology, Routing, Arbitration, and Switching

> ###其他网络结构和功能：拓扑，路由，仲裁和切换

Networks interconnecting more than two devices require mechanisms to physi- cally connect the packet source to its destination in order to transport the packet and deliver it to the correct destination. These mechanisms can be implemented in different ways and significantly vary across interconnection network domains. However, the types of network structure and functions performed by those mech- anisms are very much the same, regardless of the domain.

> 互连的网络需要两个以上的设备，需要机制将数据包源连接到其目的地，以运输数据包并将其运送到正确的目的地。这些机制可以以不同的方式实现，并且在互连网络域之间有很大变化。但是，无论域如何，这些机械主义执行的网络结构和功能的类型都是非常相同的。

When multiple devices are interconnected by a network, the connections between them oftentimes cannot be permanently established with dedicated links.

> 当多个设备通过网络互连时，它们之间的连接通常无法通过专用链接永久建立。

This could either be too restrictive as all the packets from a given source would go to the same one destination (and not to others) or prohibitively expensive as a ded- icated link would be needed from every source to every destination (we will eval- uate this further in the next section). Therefore, networks usually share paths among different pairs of devices, but how those paths are shared is determined by the network connection structure, commonly referred to as the network _topol- ogy_. Topology addresses the important issue of “_What paths are possible for packets?_” so packets reach their intended destinations.

> 这可能是过于限制的，因为来自给定来源的所有数据包都将转到一个目的地(而不是其他目的地)，或者是昂贵的，因为每个源到每个目的地都需要推定的链接(我们将评估 - 在下一部分中进一步介绍)。因此，网络通常在不同的设备对之间共享路径，但是如何共享这些路径是由网络连接结构确定的，通常称为网络_topol- ogy_。拓扑解决了“ _数据包可以使用什么路径？”的重要问题，因此数据包到达了预期的目的地。

Every network that interconnects more than two devices also requires some mechanism to deliver each packet to the correct destination. The associated func- tion is referred to as _routing_, which can be defined as the set of operations that need to be performed to compute a valid path from the packet source to its destinations. Routing addresses the important issue of “_Which of the possible paths are allow- able (valid) for packets?_” so packets reach their intended destinations. Depending on the network, this function may be executed at the packet source to compute the entire path, at some intermediate devices to compute fragments of the path on the fly, or even at every possible destination device to verify whether that device is the intended destination for the packet. Usually, the packet header shown in [Figure F.4](#_bookmark601) is extended to include the necessary routing information.

> 每个互连的网络都超过两个设备都需要一些机制将每个数据包传递到正确的目的地。关联的函数称为_ROUTING_，可以定义为需要执行的一组操作，以计算从数据包源到其目的地的有效路径。路由解决了“ _哪个可能的路径的允许(有效)对数据包的重要问题？根据网络的不同，可以在数据包源执行此功能以计算整个路径，在某些中间设备上，以计算即时的路径片段，甚至在每个可能的目标设备上以验证该设备是否为预期的目的地对于数据包。通常，[图 F.4]中显示的数据包标头(#_ bookmark601)被扩展到包括必要的路由信息。

In general, as networks usually contain shared paths or parts thereof among dif- ferent pairs of devices, packets may request some shared resources. When several packets request the same resources at the same time, an _arbitration_ function is required to resolve the conflict. Arbitration, along with flow control, addresses the important issue of “_When are paths available for packets?_” Every time arbitra- tion is performed, there is a winner and possibly several losers. The losers are not granted access to the requested resources and are typically buffered. As indicated in the previous section, flow control may be implemented to prevent buffer overflow. The winner proceeds toward its destination once the granted resources are switched in, providing a path for the packet to advance. This function is referred to as _switch- ing_. Switching addresses the important issue of “_How are paths allocated to packets?_” To achieve better utilization of existing communication resources, most networks do not establish an entire end-to-end path at once. Instead, as explained in [Section F.5](#network-routing-arbitration-and-switching), paths are usually established one fragment at a time.

> 通常，由于网络通常包含共享路径或在不同对设备之间的部分，因此数据包可能需要一些共享资源。当几个数据包同时请求相同的资源时，需要一个_arbitration_函数才能解决冲突。仲裁以及流量控制，解决了“ _何时可用于数据包的路径？”的重要问题。失败者没有被授予访问所请求的资源，通常会被缓冲。如上一节所示，可以实现流量控制以防止缓冲区溢出。一旦授予资源进入，获胜者就会前往其目的地，为数据包提供了一条途径。此功能称为_switch- _。切换解决了“ _如何分配到数据包的路径？_”的重要问题，以更好地利用现有的通信资源，大多数网络不会一次建立整个端到端路径。取而代之的是，如[F.5](＃Network-Routing-Arbitration and-Switching)所述，通常一次建立一个路径。

These three network functions—routing, arbitration, and switching—must be implemented in every network connecting more than two devices, no matter what form the network topology takes. This is in addition to the basic functions men- tioned in the previous section. However, the complexity of these functions and the order in which they are performed depends on the category of network topol- ogy, as discussed below. In general, routing, arbitration, and switching are required to establish a valid path from source to destination from among the possible paths provided by the network topology. Once the path has been established, the packet transport functions previously described are used to reliably transmit packets and receive them at the corresponding destination. Flow control, if implemented, pre- vents buffer overflow by throttling the sender. It can be implemented at the end-to- end level, the link level within the network, or both.

> 无论网络拓扑采取哪种形式，这三个网络功能(贯穿，仲裁和切换)都必须在连接两个以上设备的每个网络中实现。这是上一节中提到的基本功能的补充。但是，这些功能的复杂性及其执行顺序取决于网络倾向的类别，如下所述。通常，需要从网络拓扑提供的可能的路径之间建立从源到目的地的有效路径，需要建立一个有效的路径。一旦建立了路径，先前描述的数据包传输功能用于可靠地传输数据包并在相应的目的地接收它们。如果实现了流量控制，则通过限制发件人来预测缓冲区溢出。它可以在端到端级别，网络中的链接级别或两者兼而有之实现。

### Shared-Media Networks

> ###共享媒体网络

The simplest way to connect multiple devices is to have them share the network media, as shown for the bus in [Figure F.8](#_bookmark605) (a). This has been the traditional way of interconnecting devices. The shared media can operate in _half-duplex_ mode, where data can be carried in either direction over the media but simultaneous trans- mission and reception of data by the same device is not allowed, or in _full-duplex,_ where the data can be carried in both directions and simultaneously transmitted and received by the same device. Until very recently, I/O devices in most systems typ- ically shared a single I/O bus, and early system-on-chip (SoC) designs made use of a shared bus to interconnect on-chip components. The most popular LAN, Ether- net, was originally implemented as a half-duplex bus shared by up to a hundred computers, although now switched-media versions also exist.

> 连接多个设备的最简单方法是让它们共享网络媒体，如[图 F.8](#_ bookmark605)(a)中的总线所示。这是互连设备的传统方式。共享媒体可以在_half-duplex_模式下运行，其中可以通过媒体沿任一方向携带数据，但是不允许同时通过同一设备进行数据接收，或者在_full-Duplex 中进行数据接收，数据可以在其中数据可以可以在同时携带并同时通过同一设备传输和接收。直到最近，大多数系统中的 I/O 设备典型地共享了一个 I/O 总线，以及早期的芯片(SOC)设计的设计使用共享的总线来互连芯片组件。最受欢迎的 LAN Ether-Net 最初是由多达一百台计算机共享的半双链总线实现的，尽管现在也存在切换的媒体版本。

Given that network media are shared, there must be a mechanism to coordinate and arbitrate the use of the shared media so that only one packet is sent at a time. If the physical distance between network devices is small, it may be possible to have a central arbiter to grant permission to send packets. In this case, the network nodes may use dedicated control lines to interface with the arbiter. Centralized arbitration is impractical, however, for networks with a large number of nodes spread over large distances, so distributed forms of arbitration are also used. This is the case for the original Ethernet shared-media LAN.

> 鉴于网络媒体是共享的，必须有一种机制来协调和仲裁共享媒体的使用，以便一次仅发送一个数据包。如果网络设备之间的物理距离很小，则有可能有一个中央仲裁者授予发送数据包的许可。在这种情况下，网络节点可以使用专用的控制线与仲裁者接口。但是，对于具有大量节点分布在大距离的网络而言，集中式仲裁是不切实际的，因此还使用了分布式仲裁形式。原始的以太网共享 Media Lan 就是这种情况。

A first step toward distributed arbitration of shared media is “looking before you leap.” A node first checks the network to avoid trying to send a packet while another packet is already in the network. Listening before transmission to avoid collisions is called _carrier sensing_. If the interconnection is idle, the node tries to send. Looking first is not a guarantee of success, of course, as some other node may also decide to send at the same instant. When two nodes send at the same time, a _collision_ occurs. Let’s assume that the network interface can detect any resulting collisions by listening to hear if the data become garbled by other data appearing on the line. Listening to detect collisions is called _collision detection_. This is the second step of distributed arbitration.

> 共享媒体分配仲裁的第一步是“在跳跃之前先看”。节点首先检查网络，以避免在网络中其他数据包中尝试发送数据包。在传输之前聆听以避免碰撞称为_ carrier sensing_。如果互连是空闲的，则节点试图发送。当然，首先寻找并不是成功的保证，因为其他一些节点也可能决定以同一瞬间发送。当两个节点同时发送时，会发生一个_collision_。假设网络接口可以通过聆听来检测到数据是否被线上出现的其他数据弄乱来检测任何结果碰撞。聆听检测碰撞称为_ collision tection_。这是分布式仲裁的第二步。

Figure F.8 (a) A shared-media network versus (b) a switched-media network. Ether- net was originally a shared media network, but switched Ethernet is now available. All nodes on the shared-media networks must dynamically share the raw bandwidth of one link, but switched-media networks can support multiple links, providing higher raw aggregate bandwidth.

> 图 F.8(a)共享媒体网络与(b)交换媒体网络。Ether- Net 最初是一个共享的媒体网络，但是现在可以使用切换的以太网。共享媒体网络上的所有节点都必须动态共享一个链接的原始带宽，但是切换的媒体网络可以支持多个链接，从而提供更高的原始聚合带宽。

The problem is not solved yet. If, after detecting a collision, every node on the network waited exactly the same amount of time, listened to be sure there was no traffic, and then tried to send again, we could still have synchronized nodes that would repeatedly bump heads. To avoid repeated head-on collisions, each node whose packet gets garbled waits (or _backs off_) a random amount of time before resending. Randomization breaks the synchronization. Subsequent collisions result in exponentially increasing time between attempts to retransmit, so as not to tax the network.

> 问题尚未解决。如果在检测到碰撞后，网络上的每个节点都等待完全相同的时间，请确保没有流量，然后尝试再次发送，我们仍然可以同步的节点，这些节点会反复撞到头。为了避免重复进行正面碰撞，每个数据包都会插入等待(或_backs off_)的每个节点在延伸之前的随机时间。随机化破坏了同步。随后的碰撞导致在重新转载尝试之间的时间呈指数增加，以免对网络征税。

Although this approach controls congestion on the shared media, it is not guar- anteed to be fair—some subsequent node may transmit while those that collided are waiting. If the network does not have high demand from many nodes, this simple approach works well. Under high utilization, however, performance degrades since the media are shared and fairness is not ensured. Another distrib- uted approach to arbitration of shared media that can support fairness is to pass a token between nodes. The function of the token is to grant the acquiring node the right to use the network. If the token circulates in a cyclic fashion between the nodes, a certain amount of fairness is ensured in the arbitration process.

> 尽管这种方法控制着共享媒体上的拥堵，但公平不公平，随后的节点可能会在等待时传输。如果网络对许多节点的需求没有很高的需求，则这种简单的方法效果很好。但是，在高利用率下，由于媒体被共享并且无法确保公平性，因此性能降低。可以支持公平性的共享媒体仲裁的另一种分布方法是通过节点之间的令牌。令牌的功能是授予获取节点使用网络的权利。如果令牌在节点之间以循环方式循环，则在仲裁过程中确保一定数量的公平性。

Once arbitration has been performed and a device has been granted access to the shared media, the function of switching is straightforward. The granted device simply needs to connect itself to the shared media, thus establishing a path to every possible destination. Also, routing is very simple to implement. Given that the media are shared and attached to all the devices, every device will see every packet. Therefore, each device just needs to check whether or not a given packet is intended for that device. A beneficial side effect of this strategy is that a device can send a packet to all the devices attached to the shared media through a single transmission. This style of communication is called _broadcasting_, in contrast to _unicasting,_ in which each packet is intended for only one device. The shared media make it easy to broadcast a packet to every device or, alternatively, to a subset of devices, called _multicasting._

> 一旦执行仲裁并授予了对共享媒体的访问权限的访问，则切换的功能很简单。授予的设备只需要将自己连接到共享媒体，从而建立通往每个可能目的地的途径。同样，路由非常易于实现。鉴于媒体是所有设备共享和附加的，因此每个设备都会看到每个数据包。因此，每个设备只需要检查给定数据包是否用于该设备。该策略的一个有益的副作用是，设备可以通过单个变速箱将数据包发送到附加媒体上的所有设备。这种通信风格称为_broadcasting_，与_unicasting 相比，_ _只用于一个设备，每个数据包的意图。共享媒体使得可以轻松地将数据包广播到每个设备，又可以将其广播到一个名为_multicasting 的设备的子集。_

### Switched-Media Networks

> ###切换媒体网络

The alternative to sharing the entire network media at once across all attached nodes is to switch between disjoint portions of it shared by the nodes. Those por- tions consist of passive _point-to-point links_ between active _switch_ components that dynamically establish communication between sets of source-destination pairs. These passive and active components make up what is referred to as the network _switch fabric_ or _network fabric_, to which end nodes are connected. This approach is shown conceptually in [Figure F.8(b)](#_bookmark605). The switch fabric is described in greater detail in [Sections F.4 through F.7](#network-topology), where various black box layers for switched- media networks are further revealed. Nevertheless, the high-level view shown

> 在所有附加节点上立即共享整个网络媒体的替代方法是在节点共享的差异部分之间切换。这些措施由被动_点到点链接组成，在活动_switch_组件之间，它们在源用途对之间动态建立通信。这些被动和主动的组件构成了所谓的网络_switch Fabric_或_network Fabric_，连接了结束节点。[图 F.8(b)](#_ bookmark605)在概念上显示了此方法。在[F.4 至 F.7 节](＃网络流行)中更详细地描述了开关织物，其中进一步揭示了用于开关的媒体网络的各种黑匣子层。然而，显示的高级视图

in [Figure F.8(b)](#_bookmark605) illustrates the potential bandwidth improvement of switched- media networks over shared-media networks: aggregate bandwidth can be many times higher than that of shared-media networks, allowing the possibility of greater effective bandwidth to be achieved. At best, only one node at a time can transmit packets over the shared media, whereas it is possible for all attached nodes to do so over the switched-media network.

> 在[图 f.8(b)](#_ bookmark605)中说明了开关网络的潜在带宽改进 - 与共享媒体网络相比：汇总带宽可能比共享媒体网络的带宽要高很多倍有效的带宽可以实现。充其量，一次只有一个节点可以通过共享媒体传输数据包，而所有附加的节点都可以通过 Switched-Media 网络这样做。

Like their shared-media counterparts, switched-media networks must imple- ment the three additional functions previously mentioned: routing, arbitration, and switching. Every time a packet enters the network, it is routed in order to select a path toward its destination provided by the topology. The path requested by the packet must be granted by some centralized or distributed arbiter, which resolves conflicts among concurrent requests for resources along the same path. Once the requested resources are granted, the network “switches in” the required connec- tions to establish the path and allows the packet to be forwarded toward its desti- nation. If the requested resources are not granted, the packet is usually buffered, as mentioned previously. Routing, arbitration, and switching functions are usually performed within switched networks in this order, whereas in shared-media net- works routing typically is the last function performed.

> 像他们的共享媒体对应物一样，切换的媒体网络必须阐明前面提到的三个其他功能：路由，仲裁和切换。每次数据包进入网络时，都会对其进行路由，以便为拓扑提供的目的地选择一条路径。数据包要求的路径必须由一些集中式或分布式仲裁者授予，该仲裁者解决了同一路径的并发要求之间的冲突。一旦批准了请求的资源，网络就会“切换”所需的连接以建立路径并允许数据包转向其势力。如果未授予请求的资源，则通常会缓冲该数据包，如前所述。路由，仲裁和切换功能通常按以下顺序执行，而在共享媒体网络中，通常是执行的最后一个功能。

### Comparison of Shared- and Switched-Media Networks

> ###共享和交换媒体网络的比较

In general, the advantage of shared-media networks is their low cost, but, conse- quently, their aggregate network bandwidth does not scale at all with the number of interconnected devices. Also, a global arbitration scheme is required to resolve conflicting demands, possibly introducing another type of bottleneck and again limiting scalability. Moreover, every device attached to the shared media increases the parasitic capacitance of the electrical conductors, thus increasing the time of flight propagation delay accordingly and, possibly, clock cycle time. In addition, it is more difficult to pipeline packet transmission over the network as the shared media are continuously granted to different requesting devices.

> 通常，共享媒体网络的优势是它们的低成本，但是，由于其总体网络带宽根本不会随着互连设备的数量而扩展。同样，需要全球仲裁计划来解决冲突的需求，可能引入另一种类型的瓶颈，并再次限制可扩展性。此外，连接到共享介质的每个设备都会增加电导体的寄生电容，从而增加飞行传播延迟的时间，并可能增加时钟周期时间。此外，由于不断授予不同请求设备的共享媒体，因此很难通过网络进行数据包传输。

The main advantage of switched-media networks is that the amount of network resources implemented scales with the number of connected devices, increasing the aggregate network bandwidth. These networks allow multiple pairs of nodes to communicate simultaneously, allowing much higher effective network band- width than that provided by shared-media networks. Also, switched-media net- works allow the system to scale to very large numbers of nodes, which is not feasible when using shared media. Consequently, this scaling advantage can, at the same time, be a disadvantage if network resources grow superlinearly. Net- works of superlinear cost that provide an effective network bandwidth that grows only sublinearly with the number of interconnected devices are inefficient designs for many applications and interconnection network domains.

> 切换媒体网络的主要优点是，通过连接设备的数量实现的网络资源数量，增加了聚合网络带宽。这些网络允许多对节点同时通信，从而使有效的网络频率宽度比共享媒体网络提供的更高。此外，切换的媒体网络工作使系统可以扩展到大量的节点，在使用共享媒体时，这是不可行的。因此，如果网络资源超线性增长，则这种缩放优势可以同时成为一个劣势。超线性成本的网络作品提供了有效的网络带宽，该网络带宽仅随着互连设备的数量而增长，这对于许多应用程序和互连网络域而言是效率低下的设计。

### Characterizing Performance: Latency and Effective Bandwidth

> ###表征性能：延迟和有效带宽

The routing, switching, and arbitration functionality described above introduces some additional components of packet transport latency that must be taken into account in the expression for total packet latency. Assuming there is no contention for network resources—as would be the case in an unloaded network—total packet latency is given by the following:

> 上述路由，开关和仲裁功能引入了数据包传输延迟的一些其他组件，这些组件必须在表达式中考虑到总数据包延迟。假设没有关于网络资源的争论(在卸载网络中就是这种情况)，则按以下内容给出了总数据包延迟：

Here _T_<sub>R</sub>, _T_<sub>A</sub>, and _T_<sub>S</sub> are the total routing time, arbitration time, and switching time experienced by the packet, respectively, and are either measured quantities or cal- culated quantities derived from more detailed analyses. These components are added to the total propagation delay through the network links, _T_<sub>TotalProp</sub>, to give the overall time of flight of the packet.

> 这里_t_ <sub> r </sub>，_t_ <sub> a </sub>和_t_t_ <sub> s </sub>是数据包所经历的总路由时间，仲裁时间和切换时间并且要么是根据更详细的分析得出的数量或计算的数量。这些组件通过网络链接_t_ <ub> totalProp </sub>添加到总传播延迟中，以提供数据包的整体飞行时间。

The expression above gives only a lower bound for the total packet latency as it does not account for additional delays due to contention for resources that may occur. When the network is heavily loaded, several packets may request the same network resources concurrently, thus causing contention that degrades perfor- mance. Packets that lose arbitration have to be buffered, which increases packet latency by some _contention delay_ amount of waiting time. This additional delay is not included in the above expression. When the network or part of it approaches saturation, contention delay may be several orders of magnitude greater than the total packet latency suffered by a packet under zero load or even under slightly loaded network conditions. Unfortunately, it is not easy to compute analytically the total packet latency when the network is more than moderately loaded. Mea- surement of these quantities using cycle-accurate simulation of a detailed network model is a better and more precise way of estimating packet latency under such circumstances. Nevertheless, the expression given above is useful in calculating _best-case lower bounds_ for packet latency.

> 上面的表达式仅给出了总数据包延迟的下限，因为由于可能发生的资源的争议，它没有考虑到额外的延迟。当网络大量加载时，几个数据包可能会同时要求相同的网络资源，从而导致争论降低了 performence。丢失仲裁的数据包必须缓冲，这将数据包延迟增加了一些_contention 延迟_等待时间。上述表达式不包含此额外延迟。当网络或部分接近饱和度时，竞争延迟可能比零负载下的数据包甚至在略微加载的网络条件下的数据包遭受的总数据包延迟大几个数量级。不幸的是，当网络超过中等加载时，通过分析计算总数据包延迟并不容易。在这种情况下，使用详细网络模型的循环准确模拟对这些数量进行调查是一种更好，更精确的方法。然而，上面给出的表达式可用于计算数据包延迟的_best-case 下限_。

For similar reasons, effective bandwidth is not easy to compute exactly, but we can estimate _best-case upper bounds_ for it by appropriately extending the model presented at the end of the previous section. What we need to do is to find the nar- rowest section of the end-to-end network pipe by finding the network injection bandwidth (BW<sub>NetworkInjection</sub>), the network reception bandwidth (BW<sub>NetworkRecep-</sub> <sub>tion</sub>), and the network bandwidth (BW<sub>Network</sub>) across the entire network intercon- necting the devices.

> 出于类似的原因，有效的带宽不容易准确地计算，但是我们可以通过适当地扩展上一节末尾显示的模型来估计_best-case 上限_。我们需要做的是通过查找网络注入带宽(BW <sub>网络 intextive </sub>)，网络接收带宽(BW <sub> networkRecepep)来找到端到端网络管道的最低部分。-  </sub> <sub> tion </sub>)，以及整个网络互连设备的网络带宽(BW <sub>网络</sub>)。

The BW<sub>NetworkInjection</sub> can be calculated simply by multiplying the expression for link injection bandwidth, BW<sub>LinkInjection</sub>, by the total number of network injec- tion links. The BW<sub>NetworkReception</sub> is calculated similarly using BW<sub>LinkReception</sub>, but it must also be scaled by a factor that reflects application traffic and other charac- teristics. For more than two interconnected devices, it is no longer valid to assume a one-to-one relationship among sources and destinations when analyzing the effect of flow control on link reception bandwidth. It could happen, for example, that several packets from different injection links arrive concurrently at the same recep- tion link for applications that have many-to-one traffic characteristics, which causes contention at the reception links. This effect can be taken into account by an _average reception factor_ parameter, σ, which is either a measured quantity or a calculated quantity derived from detailed analysis. It is defined as the average fraction or percentage of packets arriving at reception links that can be accepted. Only those packets can be immediately delivered, thus reducing network reception bandwidth by that factor. This reduction occurs as a result of application behavior regardless of internal network characteristics. Finally, BW<sub>Network</sub> takes into account the internal characteristics of the network, including contention. We will progressively derive expressions in the following sections that will enable us to calculate this as more details are revealed about the internals of our black box interconnection network.

> 可以通过将链接注入带宽的表达式乘以 BW <sub> linkInctive </sub>来计算 BW <sub>网络注射</sub>，以乘以网络置换链接的总数。使用 BW <sub> LinkRection </sub>类似地计算了 BW <ub>网络</sub>，但还必须按照反映应用程序流量和其他特征的因素进行缩放。对于两个以上的互连设备，在分析流控制对链路接收带宽的影响时，在来源和目的地之间存在一对一关系是不再有效的。例如，可能发生的几个来自不同注入链接的数据包同时到达具有多一对一交通特征的应用程序相同的接收链接，这会在接收链路上引起争议。可以通过_aaaverage 的接收因子_参数 σ 来考虑这种效果，该效果是测量的数量或从详细分析得出的计算数量。它被定义为可以接受的接收链接的数据包的平均分数或百分比。只能立即传递这些数据包，从而将网络接收带宽减少到该因素。无论内部网络特征如何，这种降低都是由于应用行为而发生的。最后，BW <sub>网络</sub>考虑了网络的内部特征，包括争夺。我们将在以下各节中逐步得出表达式，这将使我们能够对此进行计算，因为有关黑匣子互连网络的内部内容的更多详细信息。

Overall, the effective bandwidth delivered by the network end-to-end to an application is determined by the minimum across the three sections, as described by the following:

> 总体而言，网络端到端交付给应用程序的有效带宽取决于以下三个部分的最小值，如下所述：

Let’s use the above expressions to compare the latency and effective bandwidth of shared-media networks against switched-media networks for the four intercon- nection network domains: OCNs, SANs, LANs, and WANs.

> 让我们使用上述表达式将共享媒体网络的延迟和有效带宽与四个互连网络域的交换媒体网络的延迟和有效的带宽进行比较：OCN，SANS，LANS 和 WANS。

Example Plot the total packet latency and effective bandwidth as the number of intercon- nected nodes, _N_, scales from 4 to 1024 for shared-media and switched-media OCNs, SANs, LANs, and WANs. Assume that all network links, including the injection and reception links at the nodes, each have a data bandwidth of 8 Gbps, and unicast packets of 100 bytes are transmitted. Shared-media networks share one link, and switched-media networks have at least as many network links as there are nodes. For both, ignore latency and bandwidth effects due to contention within the network. End nodes have per-packet sending and receiving overheads of _x_ + 0.05 ns/byte and 4/3(_x_) + 0.05 ns/byte, respectively, where _x_ is 0 μs for the OCN, 0.3 μs for the SAN, 3 μs for the LAN, and 30 μs for the WAN, and inter- connection distances are 0.5 cm, 5 m, 5000 m, and 5000 km, respectively. Also assume that the total routing, arbitration, and switching times are constants or func- tions of the number of interconnected nodes: _T_<sub>R</sub> 2.5 ns, _T_<sub>A</sub> 2.5(_N_) ns, and _T_<sub>S</sub> 2.5 ns for shared-media networks and _T_<sub>R</sub> _T_<sub>A</sub> _T_<sub>S</sub> 2.5(log<sub>2</sub> _N_) ns for switched-media networks. Finally, taking into account application traffic charac- teristics for the network structure, the average reception factor, σ, is assumed to be

> 示例将总数据包延迟和有效带宽绘制为互配置节点的数量，_n_，scales scales 从 4 到 1024，用于共享媒体和切换的媒体 OCN，SANS，SANS，LAN 和 WANS。假设所有网络链接，包括节点处的注入和接收链路，每个网络链接具有 8 Gbps 的数据带宽，并且传输了 100 个字节的单播数据包。共享媒体网络共享一个链接，而切换的媒体网络至少具有与节点一样多的网络链接。对于这两者，忽略由于网络中争夺而引起的延迟和带宽效应。末端节点的每包发送和接收开销为_x_ + 0.05 ns/byte 和 4/3(_x_) + 0.05 ns/byte，其中_x_为 OCN，SAN 的 OCN 为 0μs，SAN，3μs，3μs，3μsWAN 的 LAN 和 30μs 和连接距离分别为 0.5 cm，5 m，5000 m 和 5000 km。还要假设总路由，仲裁和切换时间是互连节点数量的常数或功能：_t_ <ub> r </sub> 2.5 ns，_t_t_ <sub> a </sub> a </by> a </bec> 2.5(_n_)ns 和_t_ <sub> s </sub> 2.5 ns 用于共享媒体网络和_t_ <sub> r </sub> _t_t_t_ <sub> a </sub> _t_t_t_ <sub> s </sub> s </sub> 2.5(log<sub> 2 </sub> _n_)ns ns 用于开关媒体网络。最后，考虑到网络结构的应用程序流量特征，假定平均接收系数为 σ

_Answer_ All components of total packet latency are the same as in the example given in the previous section except for time of flight, which now has additional routing, arbi- tration, and switching delays. For shared-media networks, the additional delays total 5 + 2.5(_N_) ns; for switched-media networks, they total 7.5(log<sub>2</sub> _N_) ns. Latency is plotted only for OCNs and SANs in [Figure F.9](#_bookmark606) as these networks give the more interesting results. For OCNs, _T_<sub>R</sub>, _T_<sub>A</sub>, and _T_<sub>S</sub> combine to dominate time of flight and are much greater than each of the other latency components for a moderate to large number of nodes. This is particularly so for the shared-media network. The latency increases much more dramatically with the number of nodes for shared media as compared to switched media given the difference in arbitration delay between the two. For SANs, _T_<sub>R</sub>, _T_<sub>A</sub>, and _T_<sub>S</sub> dominate time of flight for most net- work sizes but are greater than each of the other latency components in shared- media networks only for large-sized networks; they are less than the other latency components for switched-media networks but are not negligible. For LANs and WANs, time of flight is dominated by propagation delay, which dominates other latency components as calculated in the previous section; thus, _T_<sub>R</sub>, _T_<sub>A</sub>, and _T_<sub>S</sub> are negligible for both shared and switched media.

> _answer_总数据包延迟的所有组件与上一节中给出的示例相同，除了飞行时间，现在有其他路由，arbi-tration 和 Switch 延迟。对于共享媒体网络，额外的延迟总计为 5 + 2.5(_n_)ns;对于交换媒体网络，它们总计 7.5(log <un> 2 </sub> _n_)ns。[图 F.9](#_ bookmark606)中仅针对 OCN 和 SANS 绘制延迟，因为这些网络给出了更有趣的结果。对于 OCN，_t_ <sub> r </sub>，_t_ <sub> a </sub>和_t_t_ <sub> s </sub>组合到占主导地位的飞行时间，并且比其他每个延迟组件都要大得多对于中等至大量的节点。对于共享媒体网络尤其如此。鉴于两者之间的仲裁延迟差异，与切换媒体相比，随着共享媒体的节点的数量，潜伏期的增加更加急剧增加。对于 sans，_t_ <sub> r </sub>，_t_ <ub> a </sub>和_t_t_ <sub> s </sub>在大多数净工作尺寸的飞行时间中占主导地位，但大于每个飞行时间共享媒体网络中的其他延迟组件仅用于大型网络；它们比交换媒体网络的其他延迟组件少，但不可忽略。对于 LAN 和 WAN，飞行时间由传播延迟主导，这在上一节中所计算的其他延迟组件主导；因此，_t_ <sub> r </sub>，_t_ <sub> a </sub>和_t_t_ <sub> s </sub>对于共享和切换媒体都可以忽略不计。

Figure F.9 Latency versus number of interconnected nodes plotted in semi-log form for OCNs and SANs. Routing, arbitration, and switching have more ofanimpactonlatency for networks in these two domains, particularly for networks with a large number of nodes, given the low sending and receiving overheads and low propagation delay.

> 图 F.9 延迟与 OCN 和 SAN 的半模式形式绘制的互连节点的延迟与数量。鉴于较低的发送和接收开销和低传播延迟，路由，仲裁和切换在这两个域中具有更多的网络网络范围。

[Figure F.10](#_bookmark607) plots effective bandwidth versus number of interconnected nodes for the four network domains. The effective bandwidth for all shared-media net- works is constant through network scaling as only one unicast packet can be received at a time over all the network reception links, and that is further limited by the receiving overhead of each network for all but the OCN. The effective band- width for all switched-media networks increases with the number of intercon- nected nodes, but it is scaled down by the average reception factor. The receiving overhead further limits effective bandwidth for all but the OCN.

> [图 F.10](#_ bookmark607)绘制了四个网络域的有效带宽与互连节点的数量。所有共享媒体网络工作的有效带宽都是通过网络缩放来稳定的，因为在所有网络接收链接上只能一次接收一个单播数据包，并且除了所有网络的接收开销外，这都进一步限制 OCN。所有交换媒体网络的有效带宽随相互传感的节点的数量而增加，但按平均接收系数缩小。接收开销进一步限制了除 OCN 以外的所有人的有效带宽。

Figure F.10 Effective bandwidth versus number of interconnected nodes plotted in semi-log form for the four network domains. The disparity in effective bandwidth between shared- and switched-media networks for all inter- connect domains widens significantly as the number of nodes in the network increases. Only the switched on-chip network is able to achieve an effective bandwidth equal to the aggregate bandwidth for the parameters given in this example.

> 图 F.10 有效带宽与四个网络域的半木形式绘制的互连节点的数量。随着网络中的节点数量的增加，共享 - 和交换机网络之间有效带宽的差异显着扩大。只有开关的片网络才能实现与本示例中给出的参数相等的有效带宽。

Given the obvious advantages, why weren’t switched networks always used? Earlier computers were much slower and could share the network media with little impact on performance. In addition, the switches for earlier LANs and WANs took up several large boards and were about as large as an entire computer. As a con- sequence of Moore’s law, the size of switches has reduced considerably, and sys- tems have a much greater need for high-performance communication. Switched networks allow communication to harvest the same rapid advancements from sil- icon as processors and main memory. Whereas switches from telecommunication companies were once the size of mainframe computers, today we see single-chip switches and even entire switched networks within a chip. Thus, technology and application trends favor switched networks today. Just as single-chip processors led to processors replacing logic circuits in a surprising number of places, single-chip switches and switched on-chip networks are increasingly replacing shared-media networks (i.e., buses) in several application domains. As an example, PCI-Express (PCIe)—a switched network—was introduced in 2005 to replace the traditional PCI-X bus on personal computer motherboards.

> 给定明显的优势，为什么不总是使用切换网络？较早的计算机要慢得多，并且可以共享网络媒体，而对性能的影响很小。此外，较早的 LAN 和 WAN 的开关占据了几个大型板，并且与整个计算机一样大。作为摩尔定律的一致性，开关的大小已大大降低，并且系统对高性能通信的需求更大。交换网络允许通信收获与处理器和主要内存相同的快速进步。电信公司的开关曾经是大型计算机的大小，但今天我们看到了单芯片开关，甚至是芯片中的整个开关网络。因此，技术和应用趋势今天有利于切换网络。正如单芯片处理器导致处理器在令人惊讶的位置中更换逻辑电路一样，单芯片开关和切换的芯片网络越来越多地替换了几个应用程序域中的共享媒体网络(即总线)。例如，在 2005 年推出了 PCI-Express(PCIE)(PCIE)，以取代个人计算机主板上的传统 PCI-X 总线。

The previous example also highlights the importance of optimizing the routing, arbitration, and switching functions in OCNs and SANs. For these network domains in particular, the interconnect distances and overheads typically are small enough to make latency and effective bandwidth much more sensitive to how well these functions are implemented, particularly for larger-sized networks. This leads mostly to implementations based mainly on the faster hardware solutions for these domains. In LANs and WANs, implementations based on the slower but more flex- ible software solutions suffice given that performance is largely determined by other factors. The design of the topology for switched-media networks also plays a major role in determining how close to the lower bound on latency and the upper bound on effective bandwidth the network can achieve for OCN and SAN domains.

> 上一个示例还突出了 OCN 和 SAN 中优化路由，仲裁和切换功能的重要性。特别是对于这些网络域而言，互连距离和开销通常足够小，可以使延迟和有效的带宽对这些功能的实现方式更加敏感，尤其是对于大型网络。这主要导致实现主要基于这些域的更快的硬件解决方案。在 LAN 和 WAN 中，鉴于性能在很大程度上取决于其他因素，因此基于较慢但更灵活的软件解决方案的实现就足够了。开关媒体网络拓扑的设计在确定延迟下的下限和上限上的有效带宽上可以实现的 OCN 和 SAN 域上的有效带宽方面发挥了重要作用。

The next three sections touch on these important issues in switched networks, with the next section focused on topology.

> 接下来的三个部分涉及交换网络中的这些重要问题，下一节重点介绍了拓扑。
